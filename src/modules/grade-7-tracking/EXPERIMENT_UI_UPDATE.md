# 实验界面更新文档

## 更新日期
2025-10-16

## 更新内容

将原有的蜂蜜黏度实验界面改造为与7年级蒸馒头实验完全相同的UI样式。

## 变更文件

### 新增文件
1. `src/modules/grade-7-tracking/components/experiment/IntegratedExperimentPanel.jsx` - 集成实验面板组件
2. `src/modules/grade-7-tracking/styles/IntegratedExperimentPanel.module.css` - 集成面板样式

### 修改文件
1. `src/modules/grade-7-tracking/pages/Page10_Experiment.jsx` - 实验页面主组件

## 新UI设计

### 布局结构
```
┌─────────────────────────────────────────┐
│  左侧：说明面板                          │
│  - 实验步骤                              │
│  - 操作说明                              │
│  - 提示框                                │
├─────────────────────────────────────────┤
│  右侧：集成实验面板                      │
│  ┌───────────────────────────────────┐  │
│  │  [量筒1] [量筒2] [量筒3] [量筒4]   │  │
│  │   15%     17%     19%     21%      │  │
│  └───────────────────────────────────┘  │
│  ┌───────────────────────────────────┐  │
│  │  时间                              │  │
│  │  [0.0]   [0.0]   [0.0]   [0.0]     │  │
│  └───────────────────────────────────┘  │
│  ┌───────────────────────────────────┐  │
│  │  [重置] [🌡️25°C] [计时开始]        │  │
│  └───────────────────────────────────┘  │
└─────────────────────────────────────────┘
```

### 核心特性

#### 1. 4个量筒横向排列
- 每个量筒对应一个蜂蜜含水量（15%, 17%, 19%, 21%）
- 量筒内部显示蜂蜜液体（高度与含水量成正比）
- 小球动画在所有量筒中同时进行
- 使用CSS渐变和阴影效果实现真实感

#### 2. 绿色时间显示条
- 背景：绿色渐变（#66bb6a -> #43a047）
- 显示4个白色数值框，对应4个量筒的下落时间
- 字体：Tabular Nums（等宽数字）
- 初始值：0.0秒

#### 3. 底部控制区
- **重置按钮**（蓝色）：清空所有时间记录
- **温度控制器**（温度计图标）：点击展开5档温度选项（25°C-45°C）
- **计时开始按钮**（蓝色）：启动所有量筒的小球下落动画

#### 4. 小球动画
- 使用 `requestAnimationFrame` 实现平滑动画
- 动画时长根据物理模型动态计算
- 4个小球同时开始，但根据各自的下落时间结束
- 小球样式：灰色金属球，带有径向渐变和阴影

### 物理模型

下落时间计算公式基于真实实验数据：
- 含水量：15%, 17%, 19%, 21%
- 温度：25°C, 30°C, 35°C, 40°C, 45°C
- 包含±3%的随机波动以模拟测量误差

示例数据：
- 25°C, 15%含水量 → 约16.5秒
- 45°C, 21%含水量 → 约0.3秒

规律：
- 含水量 ↑ → 黏度 ↓ → 下落时间 ↓
- 温度 ↑ → 黏度 ↓ → 下落时间 ↓

## 样式特点

### 颜色方案
- 主容器背景：绿色渐变（#e8f5e9 -> #c8e6c9）
- 量筒边框：灰蓝色（#78909c）
- 蜂蜜液体：橙色渐变（#ffb74d -> #ffa726）
- 时间条背景：绿色渐变（#66bb6a -> #43a047）
- 小球：灰色金属质感
- 按钮：蓝色渐变，悬停效果

### 响应式设计
- 桌面（1024px+）：完整布局
- 平板（768px-1024px）：缩小量筒尺寸
- 移动（<768px）：控制按钮垂直排列

## 交互流程

### 1. 初始状态
- 温度默认25°C
- 所有量筒时间显示0.0
- 所有按钮可用

### 2. 调整温度
1. 点击温度计按钮
2. 展开下拉菜单显示5个温度选项
3. 选择目标温度
4. 菜单关闭，按钮显示新温度

### 3. 开始实验
1. 点击"计时开始"按钮
2. 所有按钮禁用（防止重复点击）
3. 为4个量筒分别计算下落时间
4. 4个小球同时从顶部开始下落
5. 根据各自时间动态更新位置

### 4. 实验完成
1. 所有小球到达底部
2. 绿色时间条显示最终时间
3. 按钮重新启用
4. 实验记录添加到历史

### 5. 重置实验
1. 点击"重置"按钮
2. 所有时间归零
3. 小球消失
4. 准备下次实验

## 数据记录

### 操作日志
- 点击"计时开始" → 记录温度和含水量
- 动画完成 → 记录所有量筒的下落时间
- 点击"重置" → 记录重置操作

### 答案收集
- 每次实验完成后，收集一条记录：
```json
{
  "targetElement": "实验记录_1",
  "value": [
    {"waterContent": 15, "fallTime": 16.5},
    {"waterContent": 17, "fallTime": 5.7},
    {"waterContent": 19, "fallTime": 2.9},
    {"waterContent": 21, "fallTime": 1.5}
  ]
}
```

### 实验历史
显示在实验面板下方，包含：
- 实验序号
- 实验时间戳
- 数据组数

## 测试指南

### 本地测试步骤

1. **配置Mock模式**
   ```bash
   # 在 .env 文件中
   VITE_USE_MOCK=1
   ```

2. **修改Mock响应**
   编辑 `vite.config.js` 第31行左右：
   ```javascript
   url: '/grade-7-tracking',
   pageNum: '8'  // 直接跳转到实验页面
   ```

3. **启动开发服务器**
   ```bash
   npm run dev
   ```

4. **访问应用**
   - 打开 http://localhost:3000
   - 使用任意账号密码登录
   - 应自动进入实验页面（Page 8）

### 功能测试清单

- [ ] **页面加载**
  - [ ] 左侧说明面板显示正确
  - [ ] 右侧实验面板显示4个量筒
  - [ ] 温度控制器显示25°C
  - [ ] 所有按钮可点击

- [ ] **温度选择**
  - [ ] 点击温度计按钮展开选项
  - [ ] 可以选择5个温度（25°C-45°C）
  - [ ] 选择后菜单关闭
  - [ ] 按钮显示选中的温度

- [ ] **开始实验**
  - [ ] 点击"计时开始"按钮
  - [ ] 4个小球同时出现并开始下落
  - [ ] 所有按钮禁用（灰色）
  - [ ] 小球动画平滑流畅

- [ ] **实验完成**
  - [ ] 小球停在量筒底部
  - [ ] 绿色时间条显示准确时间
  - [ ] 含水量高的小球时间更短
  - [ ] 按钮重新启用

- [ ] **不同温度测试**
  - [ ] 选择不同温度重复实验
  - [ ] 温度越高，时间越短
  - [ ] 数据符合物理规律

- [ ] **重置功能**
  - [ ] 点击"重置"按钮
  - [ ] 时间显示归零
  - [ ] 小球消失
  - [ ] 可以重新开始实验

- [ ] **历史记录**
  - [ ] 完成实验后显示历史记录卡片
  - [ ] 显示实验序号和时间戳
  - [ ] 多次实验历史累积

- [ ] **下一页按钮**
  - [ ] 未完成实验时禁用
  - [ ] 完成至少一次实验后启用
  - [ ] 点击后提交数据并跳转

- [ ] **响应式设计**
  - [ ] 在不同屏幕尺寸下布局正常
  - [ ] 移动端控制按钮垂直排列

- [ ] **样式一致性**
  - [ ] 与蒸馒头实验样式相似
  - [ ] 颜色和字体统一
  - [ ] 动画效果流畅

### 浏览器兼容性
- ✅ Chrome 90+
- ✅ Firefox 88+
- ✅ Safari 14+
- ✅ Edge 90+

### 已知问题
无

## 后续优化建议

1. **性能优化**
   - 使用CSS动画代替JS动画（更高性能）
   - 添加动画节流

2. **用户体验**
   - 添加音效（小球落地）
   - 添加震动反馈（移动端）
   - 改进温度选择器交互

3. **数据可视化**
   - 添加折线图展示温度-时间关系
   - 显示实验数据对比

4. **教学辅助**
   - 添加动画暂停/慢放功能
   - 显示实时速度和位置
   - 添加理论解释弹窗

## 技术栈
- React 18
- CSS Modules
- requestAnimationFrame API
- React Hooks (useState, useEffect, useCallback)
- PropTypes

## 参考资料
- 7年级蒸馒头实验 UI设计
- 物理模型数据表：[src/modules/grade-7-tracking/utils/physicsModel.js](./utils/physicsModel.js)
- 配置文件：[src/modules/grade-7-tracking/config.js](./config.js)

---

**更新人员**: Claude Code
**审核状态**: 待审核
**下次更新**: 根据测试反馈调整
