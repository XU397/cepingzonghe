# Feature Specification: 无人机航拍交互课堂子模块

**Feature Branch**: `002-8`
**Created**: 2025-11-19
**Status**: Draft
**Input**: 8年级物理科学探究实验 - 无人机成像与地面采样距离

## User Scenarios & Testing *(mandatory)*

### User Story 1 - 完成无人机航拍模拟实验 (Priority: P1)

学生通过调整无人机的飞行高度和镜头焦距参数，进行航拍模拟实验，观察不同参数组合下的地面采样距离(GSD)变化，理解变量控制的科学方法。

**Why this priority**: 这是本子模块的核心交互功能，直接评估学生的实验操作能力和变量控制理解。没有这个功能，整个评估模块无法运行。

**Independent Test**: 学生可以在实验页面独立调整参数、执行拍照操作，并观察GSD数值和图像清晰度变化，验证实验交互的完整性。

**Acceptance Scenarios**:

1. **Given** 学生进入实验页面，**When** 选择高度100米和焦距8毫米并点击拍照，**Then** 系统显示GSD值为3.01厘米/像素，航拍图像呈现高模糊度
2. **Given** 学生已完成一次拍照，**When** 调整焦距为50毫米并再次拍照，**Then** 系统显示GSD值为0.48厘米/像素，航拍图像呈现清晰画面
3. **Given** 学生在实验中，**When** 点击重置按钮，**Then** 所有参数恢复默认值，实验记录清空

---

### User Story 2 - 完成实验数据分析与结论 (Priority: P2)

学生基于实验观察数据，分析焦距和高度对GSD的影响规律，回答选择题并撰写综合结论，展示数据分析和科学推理能力。

**Why this priority**: 数据分析是科学探究的关键环节，评估学生从实验数据中提取规律的能力。此功能依赖P1实验功能产生的数据。

**Independent Test**: 学生可以在分析页面完成选择题和文本输入，系统验证答案完整性后允许继续。

**Acceptance Scenarios**:

1. **Given** 学生在焦距分析页面，**When** 选择"50毫米"作为最小GSD对应焦距，**Then** 系统记录该选择并允许继续下一页
2. **Given** 学生在高度分析页面，**When** 未选择任何选项就点击下一页，**Then** 系统显示提示"请选择一个答案后再继续"
3. **Given** 学生在结论页面，**When** 完成单选题并输入超过5个字符的理由说明，**Then** 系统验证通过并允许提交

---

### User Story 3 - 阅读背景知识与形成假设 (Priority: P3)

学生阅读无人机航拍的背景知识，理解实验原理，并回答关于变量控制的思考问题，为实验操作做好准备。

**Why this priority**: 背景知识是实验的铺垫，但不是核心评估点。学生可以在理解基本概念后快速进入实验环节。

**Independent Test**: 学生可以阅读背景内容，完成文本输入题后继续下一步。

**Acceptance Scenarios**:

1. **Given** 学生进入背景知识页面，**When** 等待5秒后，**Then** 下一页按钮变为可用
2. **Given** 学生在假设思考页面，**When** 输入少于5个字符的内容并点击下一页，**Then** 系统显示提示"请输入至少5个字符的思考内容"
3. **Given** 学生输入合格的思考内容，**When** 点击下一页，**Then** 系统保存答案并导航至实验页面

---

### User Story 4 - 确认注意事项并开始评测 (Priority: P4)

学生在开始评测前阅读注意事项，确认理解后进入正式答题环节，确保学生了解评测规则。

**Why this priority**: 这是流程入口，但属于标准化的规则确认，不涉及核心评估内容。

**Independent Test**: 学生可以阅读注意事项，等待倒计时结束后勾选确认框并继续。

**Acceptance Scenarios**:

1. **Given** 学生进入注意事项页面，**When** 立即尝试勾选确认框，**Then** 确认框处于禁用状态无法勾选
2. **Given** 倒计时30秒结束，**When** 学生勾选"我已阅读并理解上述注意事项"，**Then** 下一页按钮变为可用
3. **Given** 学生未勾选确认框，**When** 点击下一页，**Then** 系统显示提示"请先阅读注意事项并勾选确认后再继续"

---

### User Story 5 - 中途刷新后恢复进度 (Priority: P5)

学生因网络波动或意外刷新页面后，系统恢复其答题进度和已填写内容，避免数据丢失。

**Why this priority**: 这是系统健壮性要求，确保学生在意外情况下不会丢失作答进度。

**Independent Test**: 在任意页面刷新浏览器，系统恢复到正确页面并回填已保存的答案。

**Acceptance Scenarios**:

1. **Given** 学生在第5页作答了部分内容，**When** 刷新浏览器，**Then** 系统恢复到第5页并回填已保存答案
2. **Given** 学生在实验页面完成了多次操作，**When** 刷新浏览器，**Then** 系统恢复实验操作历史

---

### Edge Cases

- 当学生在20分钟内未完成所有页面时，系统自动提交当前页数据，未作答题目标记为"超时未回答"，然后导航至下一个Flow步骤
- 当网络提交失败时，系统显示错误提示并阻断导航，使用重试机制（最多3次）直到成功
- 当会话过期（401错误）时，系统清理状态并重定向到登录页面
- 当学生尝试返回上一页时，系统阻止该操作（评估模式为单向前进）
- 当GSD查找表中未找到对应参数组合时，系统使用默认值并记录警告日志

## Requirements *(mandatory)*

### Functional Requirements

**注意事项确认**
- **FR-001**: 系统 MUST 在注意事项页面显示30秒倒计时，倒计时结束前确认框处于禁用状态
- **FR-002**: 系统 MUST 在学生勾选确认框后才允许点击下一页进入正式评测

**背景与假设**
- **FR-003**: 系统 MUST 在背景知识页面强制阅读5秒后才允许继续
- **FR-004**: 系统 MUST 验证假设思考页面的文本输入长度大于5个字符

**实验操作**
- **FR-005**: 系统 MUST 提供3个飞行高度选项（100米、200米、300米）和3个焦距选项（8毫米、24毫米、50毫米）
- **FR-006**: 系统 MUST 根据选定参数组合显示对应的GSD数值（9种组合，范围0.48-9.04厘米/像素）
- **FR-007**: 系统 MUST 根据GSD数值调整航拍图像的模糊程度（GSD越大越模糊）
- **FR-008**: 系统 MUST 记录每次实验操作（参数调整、拍照、重置）及对应的GSD结果

**数据分析**
- **FR-009**: 系统 MUST 验证焦距分析页面和高度分析页面的单选题必须选择一个选项
- **FR-010**: 系统 MUST 验证结论页面的单选题和文本输入（理由长度大于5个字符）都已完成

**计时与提交**
- **FR-011**: 系统 MUST 在20分钟任务时间内完成所有页面，超时自动提交并导航至下一步骤
- **FR-012**: 系统 MUST 在每次页面切换前提交当前页数据，提交失败时阻断导航并显示重试选项
- **FR-013**: 系统 MUST 对超时未作答的题目填充"超时未回答"

**进度恢复**
- **FR-014**: 系统 MUST 在页面刷新后恢复到正确页面并回填已保存的答案
- **FR-015**: 系统 MUST 恢复实验操作历史以支持学生继续实验

**事件记录**
- **FR-016**: 系统 MUST 记录所有页面进入/退出事件、用户操作事件和校验阻断事件
- **FR-017**: 系统 MUST 为每个答案和操作生成连续递增的编码

### Key Entities

- **实验参数组合**: 飞行高度（100/200/300米）和镜头焦距（8/24/50毫米）的组合，共9种
- **GSD查找表**: 参数组合与地面采样距离的映射关系，用于显示实验结果
- **操作记录**: 学生的每次交互操作，包含目标元素、事件类型、值和时间
- **答案数据**: 学生在各页面的作答内容，包含目标元素、值和序号
- **页面映射**: 子页面编号与页面标识的对应关系，用于进度恢复和导航

## Success Criteria *(mandatory)*

### Measurable Outcomes

- **SC-001**: 学生可以在20分钟内完成全部7个页面的评测流程
- **SC-002**: 实验模拟器的参数切换和图像更新响应时间小于500毫秒
- **SC-003**: 页面切换时主要内容渲染时间小于500毫秒
- **SC-004**: 系统支持所有9种参数组合产生正确的GSD数值和对应的图像模糊效果
- **SC-005**: 页面刷新后进度恢复成功率达到100%，已填写答案完整回填
- **SC-006**: 数据提交失败时重试机制成功率达到95%以上
- **SC-007**: 所有用户操作事件被完整记录，无遗漏

## Assumptions

- 学生已通过登录认证并获得有效的会话信息（examNo、batchCode）
- 本子模块作为Flow的前置实验步骤，后续将衔接7年级蒸馒头模块
- 所有图片资源已压缩优化（无人机图片小于200KB，航拍示例图小于300KB）
- 学生使用的设备屏幕分辨率至少为1280x720
- 网络环境支持正常的数据提交（超时重试最多3次）
