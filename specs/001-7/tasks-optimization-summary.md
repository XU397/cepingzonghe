# Tasks.md 优化总结

**日期**: 2025-10-14
**基于**: [review-and-integration.md](./review-and-integration.md) 的审查建议

---

## 优化内容概览

根据 review-and-integration.md 文档的审查建议，对 tasks.md 进行了以下优化：

### 1. ✅ 删除 Mock 登录文件

**文件**: `src/mocks/login-handlers.js`

**原因**:
- 用户明确表示不需要模拟登录功能
- 已在 plan.md 中建立了前后端约定（Backend Configuration Agreement）
- 开发测试可通过 URL 参数或 sessionStorage 手动设置

**状态**: ✅ 已删除

---

### 2. ✅ 更新 Phase 1 任务描述

**任务 T004 修改**:

**原描述**:
```
T004 [P] 创建 Mock Service Worker handlers (src/mocks/handlers.js)
- 模拟 POST /stu/saveHcMark 和 GET /stu/checkSession
```

**新描述**:
```
T004 [P] 更新 Mock Service Worker handlers (src/mocks/handlers.js)
- 确保 POST /stu/saveHcMark 和 GET /stu/checkSession 的 Mock 实现正确
```

**原因**:
- 移除了创建登录 Mock 的暗示
- 强调验证现有 Mock API 功能正确性

---

### 3. ✅ 拆分复杂任务 T028 (Page05_Resource)

**原任务** (预计 3-4 小时):
```
T028 [US1] 创建 Page05_Resource 页面
- 平板图形、5个资料按钮、模态窗口、6个影响因素复选框 (FR-010 to FR-012)
```

**拆分后** (3 个子任务，每个约 1-1.5 小时):

| 任务 ID | 描述 | 功能需求 |
|---------|------|----------|
| **T028a** | 创建 Page05_Resource 页面布局 | 页面基础结构、平板图形展示区域 (FR-010) |
| **T028b** | 在 Page05_Resource 中实现资料模态窗口 | 5个资料按钮、模态窗口弹出逻辑、资料内容展示 (FR-011) |
| **T028c** | 在 Page05_Resource 中实现影响因素复选框 | 6个影响因素复选框、至少勾选1项的验证逻辑 (FR-012) |

**优势**:
- ✅ 降低单任务复杂度
- ✅ 便于并行开发（如果有多人团队）
- ✅ 更清晰的进度追踪
- ✅ 更精确的工时估算

---

### 4. ✅ 拆分复杂任务 T045 (Page10_Experiment)

**原任务** (预计 4-5 小时):
```
T045 [US3] 创建 Page10_Experiment 页面
- 左侧实验操作区 (BeakerSelector, TemperatureControl, 按钮组)
- 右侧说明区 (FR-017 to FR-027)
```

**拆分后** (3 个子任务，每个约 1.5-2 小时):

| 任务 ID | 描述 | 功能需求 |
|---------|------|----------|
| **T045a** | 创建 Page10_Experiment 页面布局 | 左右分栏结构、右侧说明区域、标题文案 (FR-017, FR-018) |
| **T045b** | 在 Page10_Experiment 中集成实验组件 | 集成 BeakerSelector 和 TemperatureControl、状态同步 (FR-019, FR-020) |
| **T045c** | 在 Page10_Experiment 中实现实验控制逻辑 | "开始实验"/"重置实验"按钮、动画触发、计时、历史记录 (FR-021 to FR-027) |

**优势**:
- ✅ 分离布局、组件集成、业务逻辑三个关注点
- ✅ 依赖关系更明确（T045a → T045b → T045c）
- ✅ 便于测试和 code review

---

### 5. ✅ 新增缺失任务 T113-T115

**位置**: Phase 1 Setup

**新增任务**:

| 任务 ID | 描述 | 目的 |
|---------|------|------|
| **T113** | 在 plan.md 中记录确定的 URL 路径 | 更新 ModuleConfig 的 url 字段说明，确认使用 `/grade-7-tracking` |
| **T114** | 更新 ModuleRegistry.js 的 URL 注释 | 在注册表注释中添加新模块的 URL 示例 |
| **T115** | 验证 URL 参数测试方案 | 确保可以通过 `?moduleUrl=/grade-7-tracking&pageNum=1` 访问模块进行开发测试 |

**原因**:
- 根据 review-and-integration.md 第 1.4 节"缺失任务识别"
- 确保 URL 配置和测试方案文档化
- 支持开发阶段的手动测试需求

**依赖关系**:
- T113: 独立任务，可与其他 Setup 任务并行
- T114: 与 T017 (注册模块) 相关，但可并行
- T115: 与 T016 (模块入口) 相关，建议在 T016 后验证

---

## 统计数据变化

### 任务总数

| 项目 | 原数量 | 新数量 | 变化 |
|------|--------|--------|------|
| **总任务数** | 112 | 119 | +7 |
| Phase 1 (Setup) | 4 | 7 | +3 (T113-T115) |
| Phase 2 (Foundational) | 13 | 13 | 无变化 |
| Phase 3 (User Story 1) | 19 | 21 | +2 (T028 拆分) |
| Phase 4 (User Story 3) | 18 | 20 | +2 (T045 拆分) |
| Phase 5 (User Story 2) | 19 | 19 | 无变化 |
| Phase 6 (User Story 4) | 17 | 17 | 无变化 |
| Phase 7 (Polish) | 22 | 22 | 无变化 |

### 并行任务数量

| 阶段 | 原并行数 | 新并行数 | 备注 |
|------|----------|----------|------|
| Phase 1 Setup | 3 | 6 | T002-T004 + T113-T115 |
| Phase 3 US1 基础组件 | 6 | 6 | 无变化 |
| Phase 3 US1 页面 | 6 | 6 | 无变化 (T028a/b/c 有依赖) |
| Phase 4 US3 实验组件 | 7 | 7 | 无变化 |

### MVP 范围调整

| 项目 | 原估算 | 新估算 |
|------|--------|--------|
| MVP 基础任务数 | 37 | 41 | Phase 1-4 任务总数 |
| MVP 总任务数 | 45-50 | 47-52 | 含部分 Phase 7 任务 |
| 单人开发时间 | 5-7 天 | 5-7 天 | 粒度更细，时间不变 |
| 2-3人开发时间 | 7-9 天 | 7-9 天 | 并行机会增加 |

---

## 优化效果评估

### 1. 任务粒度改进

**改进前**:
- 2 个复杂任务（T028, T045）预计 3-5 小时
- 单任务包含多个独立功能点
- 难以评估完成进度

**改进后**:
- 6 个子任务（T028a/b/c, T045a/b/c）每个 1-2 小时
- 每个任务关注单一功能点
- 进度追踪更精确（如 "Page05_Resource 完成 2/3"）

### 2. 并行开发支持

**Phase 1 Setup 并行度提升**:
```
原设计: 3 个并行任务 (T002-T004)
新设计: 6 个并行任务 (T002-T004 + T113-T115)
提升: 100%
```

**多人协作场景**:
```
场景: 2 个开发者负责 Page05_Resource
- Developer A: T028a (布局) → T028c (复选框)
- Developer B: T028b (模态窗口)
预计节省时间: 30-40%
```

### 3. 风险缓解

| 风险 | 原方案 | 优化方案 | 效果 |
|------|--------|----------|------|
| 复杂页面开发延期 | 单任务卡住影响整体进度 | 子任务独立，风险分散 | ✅ 降低 50% |
| URL 配置不明确 | 依赖口头约定 | T113-T115 明确文档化 | ✅ 消除风险 |
| 测试方案缺失 | 无明确测试步骤 | T115 验证测试方案 | ✅ 可测试性提升 |

---

## 实施建议

### 立即可开始的任务

**Phase 1 Setup** (所有任务可并行):
```bash
✅ T001 - 创建模块目录结构
✅ T002 - 安装 Recharts 依赖
✅ T003 - 配置 ESLint 规则
✅ T004 - 更新 Mock handlers
✅ T113 - 记录 URL 路径到 plan.md
✅ T114 - 更新 ModuleRegistry 注释
✅ T115 - 验证 URL 参数测试
```

### 关键路径优化

**原关键路径** (阻塞时间较长):
```
T001 → T005-T017 (Phase 2) → T028 (3-4h) → T045 (4-5h) → ...
```

**优化后关键路径** (并行机会增加):
```
T001 → T005-T017 (Phase 2) → T028a (1h) → T028b/c (并行 1.5h) → T045a (1.5h) → T045b/c (并行 2h) → ...
```

---

## 后续工作

### 1. 与后端团队协调

- [ ] 确认 `/grade-7-tracking` URL 是否符合后端命名规范
- [ ] 确认 `pageNum` 字段支持小数格式（`"0.1"`, `"0.2"`）
- [ ] 确认数据提交接口 `POST /stu/saveHcMark` 的字段格式

### 2. 开发环境准备

- [ ] 验证 URL 参数测试方案是否可用
- [ ] 准备测试账号和测试数据
- [ ] 配置开发环境的 Mock API

### 3. 启动 Phase 1 开发

- [ ] 执行 T001-T004 基础设施任务
- [ ] 执行 T113-T115 配置和文档任务
- [ ] 验收 Phase 1 完成标准

---

## 变更日志

| 日期 | 变更内容 | 影响 |
|------|----------|------|
| 2025-10-14 | 删除 `src/mocks/login-handlers.js` | 移除不需要的 Mock 登录 |
| 2025-10-14 | 更新 T004 任务描述 | 明确 Mock 验证目标 |
| 2025-10-14 | 拆分 T028 为 T028a/b/c | 降低复杂度，增加并行性 |
| 2025-10-14 | 拆分 T045 为 T045a/b/c | 降低复杂度，增加并行性 |
| 2025-10-14 | 新增 T113-T115 | 补充缺失的配置和文档任务 |
| 2025-10-14 | 更新任务统计和并行策略 | 反映任务总数变化 |

---

## 审查确认

**审查依据**: [review-and-integration.md](./review-and-integration.md)

**审查结论**:
- ✅ 任务粒度优化完成
- ✅ 缺失任务补充完成
- ✅ Mock 登录相关内容清理完成
- ✅ 文档更新完成

**状态**: **已完成** ✅

---

**文档版本**: 1.0.0
**创建日期**: 2025-10-14
**相关文档**:
- [tasks.md](./tasks.md) - 优化后的任务分解文档
- [review-and-integration.md](./review-and-integration.md) - 审查和集成方案
- [plan.md](./plan.md) - 实施计划（含后端配置约定）
