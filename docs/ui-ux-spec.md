# **HCI-Evaluation UI/UX规格说明书 (最终修订版)**

## **1.0 引言 (Introduction)**

本文件旨在详细定义"HCI-Evaluation"应用中，全新"四年级"模块的用户体验（UX）目标、信息架构、用户流程和视觉设计规格。它将作为前端开发的核心指南，确保最终实现的用户界面在**功能上遵循四年级数学火车购票测评需求**，在**视觉风格上与现有"蒸馒头"模块（7年级模块）保持完全一致**。

### **1.1 总体UX目标与原则 (Overall UX Goals & Principles)**

* **目标用户**: 四年级学生。  
* **可用性目标**:  
  * **易学性**: 用户无需额外指导，即可理解每个页面的任务和交互方式。  
  * **防错性**: 通过明确的指令和交互约束（如按钮的禁用/启用状态），最大限度地减少用户误操作的可能性。  
  * **沉浸感**: 交互内容应具有趣味性和代入感，以维持学生的注意力和参与度。  
* **设计原则**:  
  1. **视觉一致性 (核心)**: 所有新页面的布局、颜色、字体和组件样式，必须严格复现现有项目的视觉风格，确保新旧模块在观感上无缝衔接。  
  2. **清晰引导**: 每个交互步骤都应有明确的文本指令，引导用户完成任务。  
  3. **即时反馈**: 用户的每一个有效操作都应立即在界面上产生可见的响应。  
  4. **流程至上**: 严格遵守测评的单向、不可逆流程，确保测评的严肃性和有效性。

### **1.2 品牌与风格指南 (Branding & Style Guide)**

本指南基于项目真实页面代码(Page_04_Material_Reading_Factor_Selection.jsx)和样式文件分析制定，确保与7年级模块视觉风格完全一致。

* **1.2.1 页面布局 (Page Layout) - 基于实际代码架构**  
  * **顶部用户信息条 (User Info Bar)**:  
    * 背景色：渐变绿色 linear-gradient(135deg, #4CAF50 0%, #45a049 100%)  
    * 固定位置：position: fixed, top: 0, 高度50px  
    * 左侧：平台名称"新都区义务教育质量综合监测平台"  
    * 右侧：用户姓名，白色半透明背景圆角胶囊样式  
  * **主应用区 (Main Application Area)**:  
    * 背景色：--cartoon-bg: #fff9f0 (温暖的米白色)  
    * 整体布局：垂直flexbox，上方为用户信息条，下方为主内容区  
    * **左侧进度导航 (Left Progress Navigation)**:  
      * 宽度：100px，高度100%，左侧固定  
      * 背景色：--cartoon-light: #e6f7ff  
      * 垂直排列的圆形进度点，直径40px  
      * 当前步骤：--cartoon-primary: #59c1ff 蓝色背景，白色文字  
      * 已完成步骤：--cartoon-green: #67d5b5 绿色背景  
      * 连接线：垂直4px宽度，颜色为--cartoon-border  
    * **中央内容区域 (Content Area)**:  
      * 背景：白色，圆角20px  
      * 3px边框，颜色为--cartoon-border: #ffd99e  
      * 阴影：0 10px 30px var(--cartoon-shadow)  
      * 内边距：20px  
      * **关键要求**：所有内容必须在一屏内完成，不出现滚动条  
  * **计时器 (Timer)**:  
    * 位置：固定在右上角(top: 55px, right: 20px)  
    * 样式：--cartoon-secondary: #ffce6b 黄色背景，圆角30px  
    * 内容：⏱️图标 + "剩余时间 MM:SS"  
    * 边框：2px solid #ffb347

* **1.2.2 色彩方案 (Color Palette) - 严格按照global.css变量**  
  * **主色系 (Primary Colors)**:  
    * --cartoon-primary: #59c1ff (主要交互色，导航高亮)  
    * --cartoon-secondary: #ffce6b (次要强调色，计时器背景)  
    * --cartoon-accent: #ff7eb6 (强调色，按钮激活状态)  
  * **背景色系 (Background Colors)**:  
    * --cartoon-bg: #fff9f0 (全局背景)  
    * --cartoon-light: #e6f7ff (左侧导航背景)  
    * 白色: #ffffff (主内容区背景)  
  * **功能色系 (Functional Colors)**:  
    * --cartoon-green: #67d5b5 (成功/已完成状态)  
    * --cartoon-red: #ff8a80 (警告/错误状态)  
    * --cartoon-dark: #2d5b8e (主要文本色)  
  * **装饰色系 (Decorative Colors)**:  
    * --cartoon-border: #ffd99e (边框色)  
    * --cartoon-shadow: rgba(255, 188, 97, 0.3) (阴影色)  
  * **用户信息条 (User Info Bar)**:  
    * 背景渐变: linear-gradient(135deg, #4CAF50 0%, #45a049 100%)  
    * 文字: 白色 #ffffff

* **1.2.3 组件样式 (Component Styles) - 基于实际代码实现**  
  * **圆角标准**: 大容器20px，中等元素12px，小元素8px  
  * **按钮样式**:  
    * 基础按钮：padding: 12px 24px, border-radius: 12px  
    * 禁用状态：#cccccc背景，#888888文字  
    * 激活状态：--cartoon-primary背景，白色文字，悬停时上移3px  
    * "下一页"按钮位置：页面底部居中或右下角  
  * **导航项 (Step Navigation)**:  
    * 圆形：width/height: 40px, border-radius: 50%  
    * 边框：3px solid var(--cartoon-border)  
    * 当前步骤：--cartoon-primary背景，scale(1.1)放大  
    * 已完成：--cartoon-green背景  
    * 连接线：4px宽度垂直线条  
  * **内容卡片**:  
    * 白色背景，border-radius: 20px  
    * 3px边框，--cartoon-border颜色  
    * 阴影：0 10px 30px var(--cartoon-shadow)  
  * **输入框**:  
    * border: 3px solid var(--cartoon-border)  
    * border-radius: 12px  
    * 聚焦时：border-color: var(--cartoon-primary)  
  * **页面标题**:  
    * font-size: 24px, color: var(--cartoon-dark)  
    * 下划线：4px solid var(--cartoon-secondary)

### **1.3 变更日志 (Change Log)**

| 日期 | 版本 | 描述 | 作者 |
| :---- | :---- | :---- | :---- |
| 2025-07-27 | 3.0 | 终稿修订：移除所有PDF页面引用，改用详细描述；强调动画脚本实现和磁吸交互效果；明确单页面多方案展示模式。 | Sally |
| 2025-07-27 | 2.0 | 架构对齐修订：基于Page_04页面代码和global.css实际样式，完全重写UI规格，确保与7年级模块视觉一致性。 | Sally |
| 2025-07-25 | 1.1 | 重大修订：根据用户提供的截图，将视觉风格基准从PDF更改为现有项目样式。 | Sally |


## **2.0 信息架构 (Information Architecture - IA)**

信息架构定义了"火车购票"模块内容的组织结构，主要通过左侧的进度导航栏来体现。

### **2.1 站点地图 / 屏幕清单 (Site Map / Screen Inventory)**

"火车购票"模块由一系列线性页面组成，共同构成一个完整的测评流程。左侧的进度导航栏将作为这个流程的"站点地图"，向用户展示测评的主要逻辑阶段。

### **2.2 导航结构 (Navigation Structure)**

* **导航类型**: 垂直进度导航 (Vertical Progress Navigation)。  
* **内容**: 导航栏将包含11个数字标记的项，每个项对应一个测评的核心逻辑步骤。  
* **导航项列表**:  
  1. 出行方案  
  2. 出行方案  
  3. 火车购票  
  4. 火车购票: 出发站  
  5. 火车购票: 出发站  
  6. 火车购票: 出发时间  
  7. 火车购票: 出发时间  
  8. 火车购票: 出发时间  
  9. 火车购票: 车票选择  
  10. 火车购票: 车票选择  
  11. 火车购票  
* **可视化结构 (Mermaid Diagram)**:  
  代码段  
  graph TD  
      subgraph "火车购票模块导航"  
          direction LR  
          N1[1. 出行方案] --> N2[2. 出行方案]  
          N2 --> N3[3. 火车购票]  
          N3 --> N4[4. 出发站]  
          N4 --> N5[5. 出发站]  
          N5 --> N6[6. 出发时间]  
          N6 --> N7[7. 出发时间]  
          N7 --> N8[8. 出发时间]  
          N8 --> N9[9. 车票选择]  
          N9 --> N10[10. 车票选择]  
          N10 --> N11[11. 火车购票]  
      end

### **2.3 导航逻辑 (Navigation Logic)**

* **高亮规则**: 当用户进入一个新的测评页面时，导航栏中对应的逻辑阶段项将被高亮（通过改变背景色为--cartoon-primary: #59c1ff）。  
* **多对一映射**: 多个不同的交互页面可能对应同一个导航项。例如，交互式地图计算和站点推荐虽然是两个不同的交互环节，但它们在导航栏上可能都属于"出发站"这个大的逻辑阶段。因此，必须建立一个明确的映射规则，将每个页面（URL路由）与应被高亮的导航项ID关联起来。  
* **状态更新**: 导航状态的更新由主应用的状态管理系统统一控制。当页面发生切换时，状态管理系统会更新当前所处的逻辑阶段，导航栏UI则响应这个状态变化来更新高亮项。


## **3.0 用户流程 (User Flows) - 完整功能规格**

本章节将完整、顺序地定义"火车购票"模块从开始到结束的所有用户流程。每个子流程都将提供详尽的交互步骤和状态图，作为前端开发的精确指南。

### **3.1 流程一：测评引导与情景建立**

#### **3.1.1 子流程：强制阅读与确认 - 注意事项页面**

* **用户目标**: 理解并同意测评的核心规则，特别是时间限制和单向流程。  
* **对应导航项**: 无 (此页面在主导航出现前)。  
* **页面内容**: 测评注意事项说明文本，包含时间限制、操作规则等重要信息。
* **交互状态图 (Mermaid Diagram)**:  
  stateDiagram-v2  
      [*] --> TimerRunning: 页面加载  
      TimerRunning: 复选框禁用, 计时器(40s)启动  
      TimerRunning --> CheckboxEnabled: 计时器结束  
      CheckboxEnabled: 复选框可用  
      CheckboxEnabled --> Acknowledged: 用户勾选复选框  
      Acknowledged: "下一页"按钮激活  
      Acknowledged --> [*]: 用户点击"下一页"

* **详细交互步骤**:  
  1. **初始状态**: 页面加载完成。界面风格遵循现有项目样式，内容卡片中显示注意事项文本。"我已阅读并同意以上注意事项"复选框处于**禁用 (disabled)** 状态，"下一页"按钮也处于**禁用**状态。一个40秒的内部计时器启动。  
  2. **用户操作**: 用户等待阅读。  
  3. **系统响应**: 复选框标签中的 (40s) 文本实时倒数更新。  
  4. **状态变更**: 40秒计时结束后，标签中的秒数文本消失，复选框的禁用状态被解除，变为**可用 (enabled)**。  
  5. **用户操作**: 用户点击已启用的复选框。  
  6. **系统响应**: 复选框被选中，显示勾选状态。"下一页"按钮从禁用状态变为**启用 (enabled)**。  
  7. **完成**: 用户点击"下一页"，进入测评的第一个正式题目。此刻，全局的35分钟主计时器正式启动并显示在右上角。

#### **3.1.2 子流程：情景代入 - 故事背景介绍**

* **用户目标**: 了解本次测评的故事背景和任务情境。  
* **对应导航项**: "1. 出行方案"应被高亮。  
* **页面内容**: 熊猫背景图片和火车购票情境介绍文本，建立测评的故事情境。
* **交互状态图 (Mermaid Diagram)**:  
  stateDiagram-v2  
      [*] --> PageLoaded  
      PageLoaded: "下一页"按钮默认启用  
      PageLoaded --> [*]: 用户点击"下一页"

* **详细交互步骤**:  
  1. **初始状态**: 页面加载完成。中央内容卡片显示熊猫背景图和引言文本。"下一页"按钮在此页面**默认启用**，因为此页面无作答任务。  
  2. **完成**: 用户阅读后，直接点击"下一页"进入下一步。

#### **3.1.3 子流程：问题识别 - 对话分析**

* **用户目标**: 根据对话内容，提炼出小明需要解决的核心问题。  
* **对应导航项**: "2. 出行方案"应被高亮。  
* **页面内容**: 左侧展示"假期安排讨论群"的对话截图，右侧为问题和文本输入区域。
* **交互状态图 (Mermaid Diagram)**:  
  stateDiagram-v2  
      [*] --> EmptyInput: 页面加载  
      EmptyInput: 文本框为空, "下一页"按钮禁用  
      EmptyInput --> NonEmptyInput: 用户输入内容  
      NonEmptyInput: 文本框非空, "下一页"按钮激活  
      NonEmptyInput --> EmptyInput: 用户删除所有内容  
      NonEmptyInput --> [*]: 用户点击"下一页"

* **详细交互步骤**:  
  1. **初始状态**: 页面加载完成。界面左侧显示群聊对话截图，右侧为问题提示和带有占位符的多行文本输入框。"下一页"按钮为**禁用**状态。  
  2. **用户操作**: 用户在文本框中输入文字。  
  3. **系统响应**: 系统实时检测文本框内容。  
  4. **完成条件**: 当文本框经过去除首尾空格后，内容为**非空**字符串时，"下一页"按钮变为**启用**状态。如果用户再次清空文本框，按钮则恢复为禁用状态。

#### **3.1.4 子流程：因素分析 - 多选题**

* **用户目标**: 从给定选项中，选择出解决问题需要考虑的相关因素。  
* **对应导航项**: "3. 火车购票"应被高亮。  
* **页面内容**: 问题描述和六个带自定义勾选框的选项，用于多选操作。
* **交互状态图 (Mermaid Diagram)**:  
  stateDiagram-v2  
      [*] --> NoSelection: 页面加载  
      NoSelection: 未选择任何选项, "下一页"按钮禁用  
      NoSelection --> HasSelection: 用户选择至少一个选项  
      HasSelection: 已选择至少一项, "下一页"按钮激活  
      HasSelection --> NoSelection: 用户取消所有选择  
      HasSelection --> [*]: 用户点击"下一页"

* **详细交互步骤**:  
  1. **初始状态**: 页面加载完成。界面显示问题和六个带自定义勾选框的选项。"下一页"按钮为**禁用**状态。  
  2. **用户操作**: 用户点击任意一个选项。  
  3. **系统响应**: 被点击的选项进入"选中"状态（勾选框内出现对勾标记）。  
  4. **用户操作**: 用户再次点击一个已选中的选项。  
  5. **系统响应**: 该选项恢复到"未选中"状态。  
  6. **完成条件**: 当用户**至少选择了一个**选项后，"下一页"按钮变为**启用**状态。如果用户取消了所有已选项，按钮则恢复为禁用状态。

### **3.2 流程二：出发站分析与路线计算**

#### **3.2.1 子流程：交互式路线计算 - 动画地图系统**

* **用户目标**: 通过与交互式地图互动，计算出"路线1"和"路线5"的总路程。  
* **对应导航项**: 在此流程期间，左侧导航栏的"4. 火车购票: 出发站"项应始终保持高亮状态。  
* **页面内容**: 三栏布局 - 左侧路线按钮组，中央动画地图区域，右侧路程计算表格。

**核心技术要求：动画脚本实现**
* **重要说明**: 地图的5个方案通过**动画呈现形式**实现，不是分别创建五个页面。需要通过JavaScript脚本构建动画的方式来实现地图切换。
* **动画实现方式**: 
  - 使用CSS动画或JavaScript动画库（如GSAP）
  - 地图图片资源预加载，确保切换流畅
  - 路线高亮动画效果，突出显示当前选中路线
  - 淡入淡出或滑动切换效果

* **交互状态图 (Mermaid Diagram)**:  
  stateDiagram-v2  
      [*] --> InitialState: 页面加载  
      InitialState: 显示概览地图, "下一页"按钮禁用  
      InitialState --> RouteSelected: 点击任意路线按钮  
      RouteSelected: 地图动画切换到对应路线详情  
      RouteSelected --> RouteSelected: 点击其他路线按钮  
      RouteSelected --> Validation: 用户在输入框填入数值  
      Validation: 检查"路线1"和"路线5"输入框  
      Validation -->> NextEnabled: 两个输入框均有有效数值  
      NextEnabled: "下一页"按钮激活  
      NextEnabled --> [*]: 用户点击"下一页"

* **详细交互步骤**:  
  1. **初始状态**: 页面加载完成。中央内容卡片显示三栏布局：左侧是五个路线按钮，中间是概览地图，右侧是路程表格。"下一页"按钮为**禁用**状态。  
  2. **用户操作**: 用户点击左侧的任意一个"路线"按钮（例如，"路线1"）。  
  3. **系统响应**:  
     * 被点击的"路线1"按钮变为"激活"状态（例如，边框高亮）。  
     * 中央的地图区域通过**动画脚本**实现切换，显示路线1详情图，图上清晰地用彩色线条和数字标出了分段路程（4.26km 和 3.64km）。  
     * 如果之前有其他按钮被激活，则恢复为默认状态。  
     * **动画效果**: 地图切换使用淡入淡出或滑动效果，确保视觉流畅性。
  4. **用户操作**: 用户根据地图上的信息进行心算或笔算，然后在右侧表格中"路线1"对应的输入框内填入计算结果。  
  5. **重复交互**: 用户可以任意点击其他路线按钮，地图会通过**动画脚本**相应地更新为该路线的详情图。  
  6. **完成条件**: 当用户完成了对"路线1"和"路线5"的计算，并在两个对应的输入框中都填入了有效的数字后，"下一页"按钮从**禁用**状态变为**启用**状态。

#### **3.2.2 子流程：站点决策 - 推荐与说明**

* **用户目标**: 基于计算结果，推荐最佳出发站并说明理由。  
* **对应导航项**: "5. 火车购票: 出发站"应被高亮。  
* **页面内容**: 显示完整路程表格、站点单选按钮组、理由输入框，以及路线回顾按钮。
* **交互状态图 (Mermaid Diagram)**:  
  stateDiagram-v2  
      [*] --> Incomplete: 页面加载  
      Incomplete: 未选择站点或未填写理由, "下一页"按钮禁用  
      Incomplete --> Partial1: 选择站点  
      Incomplete --> Partial2: 填写理由  
      Partial1 --> Complete: 填写理由  
      Partial2 --> Complete: 选择站点  
      Complete: 站点已选且理由已填, "下一页"按钮激活  
      Complete --> [*]: 用户点击"下一页"

* **详细交互步骤**:  
  1. **初始状态**: 页面加载完成。显示包含所有正确路程的表格、站点单选项和理由输入框。"下一页"按钮为**禁用**状态。  
  2. **用户操作 (信息回顾)**: 用户可点击页面下方的"路线1"至"路线5"按钮。  
  3. **系统响应**: 弹出一个**模态框 (Modal)**，在其中显示对应的路线详情图，方便用户回顾。关闭模态框后返回当前页面。  
  4. **用户操作 (决策)**: 用户选择一个站点（单选按钮），并在文本框中填写推荐理由。  
  5. **完成条件**: 必须同时满足以下两个条件，"下一页"按钮才变为**启用**状态：1) "南充北站"或"南充站"中**已选择一个**；2) "请简要说明理由"的文本框中**内容不为空**。

### **3.3 流程三：时间规划与方案设计**

#### **3.3.1 子流程：交互教程 - 并行任务概念演示**

* **用户目标**: 理解并行任务的概念和拖拽操作方法。  
* **对应导航项**: "6. 火车购票: 出发时间"应被高亮。  
* **页面内容**: 示例图解和动画演示按钮，展示并行任务排列方式。

**核心技术要求：教程动画脚本实现**
* **重要说明**: 需要通过**构建脚本动画**的形式来显示一个任务排列方式演示。
* **动画实现方式**: 
  - 使用CSS动画或JavaScript动画库创建任务块移动演示
  - 展示如何拖动任务块、如何并排摆放任务以实现并行
  - 演示"总用时"如何根据排列实时变化
  - 动画可重复播放，便于学生多次观看学习

* **详细交互步骤**:  
  1. **初始状态**: 页面加载完成，显示示例图和一个带播放图标的按钮。"下一页"按钮**默认启用**。  
  2. **用户操作**: 用户点击播放按钮。  
  3. **系统响应**: **播放脚本动画**，清晰展示如何拖动任务块、如何并排摆放任务以实现并行、以及"总用时"如何根据排列实时变化。动画可重复播放。  
  4. **完成**: 用户理解操作后，点击"下一页"按钮。

#### **3.3.2 子流程：用户方案设计 - 双方案拖拽设计**

* **用户目标**: 运用并行思维，设计两种不同的时间安排方案，并**自行计算总用时**。  
* **对应导航项**: "7. 火车购票: 出发时间"应被高亮。  
* **页面内容**: 顶部可拖拽任务块集合，下方两个方案设计区域，每个区域配备总用时输入框。

**核心技术要求：磁吸拖拽系统**
* **重要说明**: 为了能够后期更容易地识别同学的摆放意图，需要方块之间有**磁吸效果**，以便能够容易地实现摆放方案的清晰标识，不会造成错位导致的意图识别出现偏差。
* **磁吸效果实现**:
  - **吸附网格**: 设置隐形网格系统，任务块自动对齐到网格点
  - **边缘吸附**: 任务块放置时自动与放置区域边缘、其他任务块的开始或结束时间点对齐
  - **视觉反馈**: 当任务块接近吸附点时，显示高亮引导线或阴影提示
  - **精确定位**: 确保最终摆放位置准确，便于后端算法识别学生的摆放意图
  - **容错机制**: 即使学生拖拽不够精确，系统也能自动修正到最近的合理位置

* **详细交互步骤**:  
  1. **初始状态**: 页面加载完成。顶部是五个可拖拽的任务块，下方是"方案一"和"方案二"两个空的放置区域，每个区域都带有一个**可编辑的"总用时"输入框**。"下一页"按钮为**禁用**状态。  
  2. **用户操作**: 用户从顶部将任务块拖入一个放置区。  
  3. **系统响应 (磁吸对齐)**:  
     * 任务块被放置在方案区内。  
     * **磁吸对齐效果**: 任务块在放置时，自动与放置区域的起始线、或其他任务块的边缘（开始或结束时间点）对齐，确保布局整齐易读且便于意图识别。  
     * **视觉引导**: 拖拽过程中显示吸附点提示和对齐引导线。
     * **系统不计算时间**: "总用时"输入框保持为空，等待用户输入。  
  4. **用户操作 (计算与输入)**: 用户根据自己排列的方案，自行计算关键路径总时长，并将结果**手动输入**到对应的"总用时"输入框中。  
  5. **完成条件**: "下一页"按钮必须在同时满足以下**所有条件**后才变为**启用**状态：  
     * "方案一"放置区域**至少包含一个**任务块。  
     * "方案一"的"总用时"输入框**内容不为空**。  
     * "方案二"放置区域**至少包含一个**任务块。  
     * "方案二"的"总用时"输入框**内容不为空**。

#### **3.3.3 子流程：方案评估与优化 - 条件判断与改进**

* **用户目标**: 评估一个已有方案的最优性，并在必要时提出改进方案并**自行计算改进后的总用时**。  
* **对应导航项**: "8. 火车购票: 出发时间"应被高亮。  
* **页面内容**: 小明的时间安排方案展示，是否最优的单选判断，以及条件显示的改进方案拖拽区域。

**核心技术要求：条件显示与磁吸拖拽**
* **条件显示逻辑**: 改进方案拖拽区域初始隐藏，只有当用户选择"否"时才动态显示
* **磁吸拖拽**: 与3.3.2相同的磁吸效果实现，确保改进方案摆放的准确性和可识别性

* **详细交互步骤**:  
  1. **初始状态**: 页面加载完成，显示小明的方案。用于"改进方案"的拖拽区域此时是**隐藏**的。"下一页"按钮为**禁用**状态。  
  2. **用户操作 (路径一)**: 用户选择单选按钮"是"。  
  3. **系统响应**: "下一页"按钮立即变为**启用**状态。  
  4. **用户操作 (路径二)**: 用户选择单选按钮"否"。  
  5. **系统响应**: 页面下方**动态显示**出"请拖动长方条, 画出你的改进方案"的拖拽区域，该区域也包含一个**可编辑的"总用时"输入框**。"下一页"按钮**保持禁用**。此拖拽区域的交互逻辑（包括任务块的**磁吸对齐效果**）与子流程3.3.2中的方案设计区完全相同。  
  6. **完成条件 (路径二)**: 只有当用户在新出现的拖拽区域中，同时满足以下**所有条件**后，"下一页"按钮才变为**启用**状态：  
     * 拖拽区域**至少放置了一个**任务块。  
     * 对应的"总用时"输入框**内容不为空**。

### **3.4 流程四：车票选择与购买**

#### **3.4.1 子流程：车票筛选 - 多约束条件筛选**

* **用户目标**: 根据多重约束条件，从列表中筛选出符合要求的车次。  
* **对应导航项**: "9. 火车购票: 车票选择"应被高亮。  
* **页面内容**: 包含5个车次的详细信息表格，每个车次前有圆形多选图标。
* **详细交互步骤**:  
  1. **初始状态**: 页面加载完成，显示包含5个车次的详细信息表格。"下一页"按钮为**禁用**状态。  
  2. **用户操作**: 用户根据所有约束条件，点击车次前的圆形图标进行**多选**。  
  3. **完成条件**: 用户**至少选择一个**车次后，"下一页"按钮变为**启用**状态。

#### **3.4.2 子流程：最终推荐与计价 - 四项任务完成验证**

* **用户目标**: 做出最终车次推荐，并使用自定义键盘完成票价计算。  
* **对应导航项**: "10. 火车购票: 车票选择"应被高亮。  
* **页面内容**: 筛选后的2个车次信息（带单选按钮）、推荐理由文本框、计算过程显示区、总票价输入框和自定义小键盘。
* **交互状态图 (Mermaid Diagram)**:  
  stateDiagram-v2  
      state "四项未完成" as Incomplete  
      state "三项未完成" as Partial3  
      state "两项未完成" as Partial2  
      state "一项未完成" as Partial1  
      state "全部完成" as Complete

      [*] --> Incomplete: 页面加载  
      Incomplete: "下一页"按钮禁用

      Incomplete --> Partial3: 完成任意一项  
      Partial3 --> Incomplete: 撤销操作

      Partial3 --> Partial2: 完成第二项  
      Partial2 --> Partial3: 撤销操作

      Partial2 --> Partial1: 完成第三项  
      Partial1 --> Partial2: 撤销操作

      Partial1 --> Complete: 完成最后一项  
      Complete --> Partial1: 撤销操作

      Complete: "下一页"按钮激活  
      Complete --> [*]: 用户点击"下一页"

* **详细交互步骤**:  
  1. **初始状态**: 页面加载完成。界面包含：筛选后的2个车次信息（带单选按钮）、推荐理由文本框、计算过程显示区、总票价输入框和自定义小键盘。"下一页"按钮为**禁用**状态。系统内部维护四个布尔状态值，分别对应四个任务的完成情况，初始均为 false。  
  2. **用户操作 (车次选择)**: 用户在两个车次中点击选择一个。  
  3. **系统响应**: 被选中的单选按钮激活。系统将"车次选择"状态更新为 true，并检查是否满足全部完成条件。  
  4. **用户操作 (填写理由)**: 用户在"请在此处输入你的回答"的文本框中输入内容。  
  5. **系统响应**: 系统实时检测文本框内容。当内容不为空时，将"理由填写"状态更新为 true；为空时则更新为 false。系统检查是否满足全部完成条件。  
  6. **用户操作 (输入计算过程)**: 用户点击右侧的自定义小键盘。  
  7. **系统响应**: 被点击的数字或符号被追加到"计算过程"显示区。系统实时检测该区域内容。当内容不为空时，将"公式输入"状态更新为 true；为空时则更新为 false。系统检查是否满足全部完成条件。  
  8. **用户操作 (输入总票价)**: 用户在"总票价"输入框中输入数字。  
  9. **系统响应**: 系统实时检测输入框内容。当内容不为空时，将"总价输入"状态更新为 true；为空时则更新为 false。系统检查是否满足全部完成条件。  
  10. **完成条件**: "下一页"按钮**只有在上述四个内部状态值全部为 true 时**，才从**禁用**变为**启用**。任何一项变为 false，按钮都会立刻恢复为禁用状态。

#### **3.4.3 子流程：测评完成 - 数据提交与结束**

* **用户目标**: 结束测评并提交所有作答数据。  
* **对应导航项**: "11. 火车购票"应被高亮。  
* **页面内容**: 测评完成的感谢语和"完成"按钮。
* **详细交互步骤**:  
  1. **初始状态**: 页面加载完成，显示感谢语和"完成"按钮。  
  2. **用户操作**: 用户点击"完成"按钮。  
  3. **系统响应**: **停止全局计时器**，汇总本次测评会话期间的所有作答数据，并调用API**提交最终结果**。提交成功后，可以显示成功提示或跳转到结束页面。

## **4.0 技术实现要点总结**

### **4.1 动画系统要求**
* **路线地图动画**: 使用JavaScript脚本实现5个路线方案的动画切换，确保视觉流畅性
* **教程演示动画**: 构建脚本动画展示并行任务排列方式，可重复播放
* **动画库推荐**: GSAP、Framer Motion或CSS3动画，确保跨浏览器兼容性

### **4.2 磁吸拖拽系统要求**  
* **精确对齐**: 任务块自动吸附到网格点和其他任务块边缘
* **视觉反馈**: 拖拽过程中显示对齐引导线和吸附点提示
* **意图识别**: 确保最终摆放位置准确，便于后端算法分析学生的设计意图
* **容错机制**: 自动修正不精确的拖拽操作到最近的合理位置

### **4.3 响应式交互要求**
* **实时验证**: 所有输入框和选择操作的实时状态检测
* **按钮状态管理**: 复杂的多条件按钮启用/禁用逻辑
* **模态框系统**: 路线回顾的弹窗展示功能
* **条件显示**: 基于用户选择的动态内容显示/隐藏

### **4.4 一屏显示要求**
* **无滚动条设计**: 所有页面内容必须在一屏内完整显示
* **自适应布局**: 合理的响应式设计，确保不同屏幕尺寸下的良好体验
* **内容优化**: 精确控制文本长度和组件尺寸，避免内容溢出