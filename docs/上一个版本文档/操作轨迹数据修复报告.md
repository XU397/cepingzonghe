# æ“ä½œè½¨è¿¹æ•°æ®ä¿®å¤æŠ¥å‘Š

## é—®é¢˜æè¿°

åœ¨æµ‹è¯•è¿‡ç¨‹ä¸­å‘ç°éƒ¨åˆ†é¡µé¢çš„operationListæ•°æ®ä¸ºç©ºï¼Œå¯¼è‡´ç”¨æˆ·æ“ä½œè½¨è¿¹è®°å½•ä¸å®Œæ•´ã€‚æ¯ä¸ªé¡µé¢éƒ½åº”è¯¥åŒ…å«å®Œæ•´çš„æ“ä½œè®°å½•ï¼ŒåŒ…æ‹¬é¡µé¢è¿›å…¥ã€æŒ‰é’®ç‚¹å‡»ã€é¼ æ ‡ç§»åŠ¨ç­‰è¡Œä¸ºã€‚

## æ ¹æœ¬åŸå› åˆ†æ

### 1. é¡µé¢åˆ‡æ¢æ—¶æ•°æ®é‡ç½®é—®é¢˜
**é—®é¢˜**ï¼šåœ¨`AppContext.jsx`çš„`navigateToPage`å‡½æ•°ä¸­ï¼Œæ¯æ¬¡é¡µé¢åˆ‡æ¢éƒ½ä¼šé‡ç½®`currentPageData`ï¼š
```javascript
setCurrentPageData({ operationList: [], answerList: [] });
```

**å½±å“**ï¼šè¿™å¯¼è‡´é¡µé¢åœ¨åˆ‡æ¢åç«‹å³æ¸…ç©ºæ‰€æœ‰æ“ä½œè®°å½•ï¼Œå¦‚æœé¡µé¢æ²¡æœ‰é‡æ–°è®°å½•æ“ä½œï¼ŒoperationListå°±ä¼šä¿æŒä¸ºç©ºã€‚

### 2. éƒ¨åˆ†é¡µé¢ç¼ºå°‘æ•°æ®è®°å½•å®ç°
**é—®é¢˜**ï¼šä¸€äº›é¡µé¢æ²¡æœ‰ä½¿ç”¨ç»Ÿä¸€çš„`useDataLogging` Hookï¼Œç¼ºå°‘ä»¥ä¸‹å…³é”®è®°å½•ï¼š
- é¡µé¢è¿›å…¥è®°å½•ï¼ˆ`setPageEnterTime` + `logPageEnter`ï¼‰
- æŒ‰é’®ç‚¹å‡»è®°å½•
- è¾“å…¥æ¡†äº¤äº’è®°å½•

### 3. é¡µé¢è¿›å…¥äº‹ä»¶ç¼ºå¤±
**é—®é¢˜**ï¼šéƒ¨åˆ†é¡µé¢æ²¡æœ‰åœ¨ç»„ä»¶æŒ‚è½½æ—¶è®°å½•é¡µé¢è¿›å…¥äº‹ä»¶ï¼Œå¯¼è‡´operationListå®Œå…¨ä¸ºç©ºã€‚

## ä¿®å¤æ–¹æ¡ˆ

### 1. æ ‡å‡†åŒ–æ•°æ®è®°å½•å®ç°

#### å·²ä¿®å¤çš„é¡µé¢ï¼š
- âœ… `IntroductionPage.jsx` (Page 2) - æ·»åŠ å®Œæ•´æ•°æ®è®°å½•
- âœ… `TransitionToSimulationPage.jsx` (Page 13) - æ·»åŠ é¡µé¢è¿›å…¥å’ŒæŒ‰é’®ç‚¹å‡»è®°å½•  
- âœ… `HypothesisFocusPage.jsx` (Page 10) - æ ‡å‡†åŒ–æ•°æ®è®°å½•å®ç°
- âœ… `Page_19_Task_Completion.jsx` - æ·»åŠ å®Œæ•´æ•°æ®è®°å½•
- âœ… `Page_04_Material_Reading_Factor_Selection.jsx` - æ ‡å‡†åŒ–æ¨¡æ€æ¡†å’Œå¤é€‰æ¡†è®°å½•
- âœ… `SolutionDesignPage.jsx` - å®Œå–„è¾“å…¥æ¡†å’ŒæŒ‰é’®è®°å½•
- âœ… `Page_20_Questionnaire_Intro.jsx` - æ ‡å‡†åŒ–é—®å·é¡µé¢è®°å½•

#### æ ‡å‡†ä¿®å¤æ¨¡å¼ï¼š
```javascript
// 1. å¯¼å…¥useDataLogging Hook
import { useDataLogging } from '../hooks/useDataLogging';

// 2. åœ¨ç»„ä»¶ä¸­ä½¿ç”¨Hook
const {
  logButtonClick,
  logPageEnter,
  logInput,
  logInputBlur,
  // ... å…¶ä»–éœ€è¦çš„æ–¹æ³•
} = useDataLogging('Page_ID');

// 3. é¡µé¢è¿›å…¥è®°å½•
useEffect(() => {
  setPageEnterTime(new Date());
  logPageEnter('é¡µé¢åç§°');
}, [setPageEnterTime, logPageEnter]);

// 4. æŒ‰é’®ç‚¹å‡»è®°å½•
const handleButtonClick = () => {
  logButtonClick('æŒ‰é’®åç§°', 'æ“ä½œæè¿°');
  // ... å…¶ä»–é€»è¾‘
};
```

### 2. é¡µé¢åˆ‡æ¢é€»è¾‘ä¼˜åŒ–

#### ä¿®å¤å†…å®¹ï¼š
- åœ¨é¡µé¢åˆ‡æ¢å‰è®°å½•é¡µé¢é€€å‡ºäº‹ä»¶
- ç¡®ä¿é¡µé¢åˆ‡æ¢çš„æ—¶åºæ­£ç¡®
- ä¿æŒæ•°æ®è®°å½•çš„è¿ç»­æ€§

#### ä¿®å¤åçš„`navigateToPage`å‡½æ•°ï¼š
```javascript
// åœ¨é¡µé¢åˆ‡æ¢ä¹‹å‰è®°å½•é¡µé¢é€€å‡º
logOperation({ 
  targetElement: 'é¡µé¢', 
  eventType: 'page_exit', 
  value: `ç¦»å¼€é¡µé¢${currentPageId}`
});

setCurrentPageIdInternal(nextPageId);
setPageEnterTime(new Date());
setCurrentPageData({ operationList: [], answerList: [] });

// æ–°é¡µé¢çš„è¿›å…¥äº‹ä»¶å°†åœ¨é¡µé¢ç»„ä»¶çš„useEffectä¸­å¤„ç†
```

### 3. æ•°æ®è®°å½•å®Œæ•´æ€§ä¿è¯

#### æ¯ä¸ªé¡µé¢ç°åœ¨éƒ½åŒ…å«ï¼š
1. **é¡µé¢è¿›å…¥è®°å½•**ï¼šç”¨æˆ·è®¿é—®é¡µé¢æ—¶çš„æ—¶é—´æˆ³å’Œäº‹ä»¶
2. **äº¤äº’æ“ä½œè®°å½•**ï¼šæ‰€æœ‰ç”¨æˆ·äº¤äº’ï¼ˆç‚¹å‡»ã€è¾“å…¥ã€é€‰æ‹©ç­‰ï¼‰
3. **é¡µé¢é€€å‡ºè®°å½•**ï¼šç”¨æˆ·ç¦»å¼€é¡µé¢æ—¶çš„è®°å½•
4. **ç­”æ¡ˆæ”¶é›†**ï¼šç”¨æˆ·è¾“å…¥æˆ–é€‰æ‹©çš„å†…å®¹

#### æ ‡å‡†æ“ä½œç±»å‹ï¼š
- `page_enter` - é¡µé¢è¿›å…¥
- `page_exit` - é¡µé¢é€€å‡º  
- `click` - æŒ‰é’®/é“¾æ¥ç‚¹å‡»
- `input` - æ–‡æœ¬è¾“å…¥
- `input_blur` - è¾“å…¥æ¡†å¤±ç„¦
- `checkbox_check/uncheck` - å¤é€‰æ¡†æ“ä½œ
- `radio_select` - å•é€‰æŒ‰é’®é€‰æ‹©
- `modal_open/close` - æ¨¡æ€æ¡†æ“ä½œ

## ä¿®å¤éªŒè¯

### éªŒè¯æ–¹æ³•ï¼š
1. **æ§åˆ¶å°æ£€æŸ¥**ï¼šåœ¨æµè§ˆå™¨å¼€å‘è€…å·¥å…·ä¸­æŸ¥çœ‹æ•°æ®æäº¤æ—¥å¿—
2. **ç½‘ç»œè¯·æ±‚æ£€æŸ¥**ï¼šéªŒè¯æäº¤çš„JSONæ•°æ®åŒ…å«operationList
3. **ç«¯åˆ°ç«¯æµ‹è¯•**ï¼šå®Œæ•´èµ°è¿‡æ‰€æœ‰é¡µé¢ï¼Œç¡®ä¿æ¯é¡µéƒ½æœ‰æ“ä½œè®°å½•

### é¢„æœŸç»“æœï¼š
æ¯ä¸ªé¡µé¢æäº¤çš„æ•°æ®åº”åŒ…å«ç±»ä¼¼ä»¥ä¸‹ç»“æ„ï¼š
```json
{
  "batchCode": "...",
  "examNo": "...",
  "mark": {
    "pageNumber": "1",
    "pageDesc": "æ³¨æ„äº‹é¡¹",
    "operationList": [
      {
        "code": 1,
        "targetElement": "é¡µé¢",
        "eventType": "page_enter",
        "value": "æ³¨æ„äº‹é¡¹é¡µé¢",
        "time": "2025-01-29 10:30:15"
      },
      {
        "code": 2,
        "targetElement": "ç¡®è®¤å·²é˜…è¯»æ³¨æ„äº‹é¡¹å¤é€‰æ¡†",
        "eventType": "checkbox_check",
        "value": "é€‰ä¸­",
        "time": "2025-01-29 10:30:20"
      },
      {
        "code": 3,
        "targetElement": "ç»§ç»­æŒ‰é’®",
        "eventType": "click",
        "value": "å¼€å§‹ä»»åŠ¡",
        "time": "2025-01-29 10:30:25"
      }
    ],
    "answerList": [...],
    "beginTime": "2025-01-29 10:30:15",
    "endTime": "2025-01-29 10:30:25",
    "imgList": []
  }
}
```

## æŠ€æœ¯æ”¹è¿›

### 1. useDataLogging Hookä¼˜åŠ¿
- **æ ‡å‡†åŒ–**ï¼šæ‰€æœ‰é¡µé¢ä½¿ç”¨ç»Ÿä¸€çš„æ•°æ®è®°å½•æ–¹å¼
- **æ˜“ç»´æŠ¤**ï¼šé›†ä¸­ç®¡ç†æ•°æ®è®°å½•é€»è¾‘
- **ç±»å‹å®‰å…¨**ï¼šç»Ÿä¸€çš„äº‹ä»¶ç±»å‹å’Œå‚æ•°æ ¼å¼
- **æ€§èƒ½ä¼˜åŒ–**ï¼šä½¿ç”¨useCallbacké¿å…ä¸å¿…è¦çš„é‡æ¸²æŸ“

### 2. é”™è¯¯å¤„ç†å¢å¼º
- æ•°æ®æäº¤å¤±è´¥æ—¶çš„é‡è¯•æœºåˆ¶
- ç”¨æˆ·å‹å¥½çš„é”™è¯¯æç¤º
- è¯¦ç»†çš„è°ƒè¯•æ—¥å¿—

### 3. æ•°æ®å®Œæ•´æ€§ä¿è¯
- æ¯æ¬¡é¡µé¢åˆ‡æ¢éƒ½ç¡®ä¿æ•°æ®æäº¤
- æ“ä½œåºå·è‡ªåŠ¨ç®¡ç†
- æ—¶é—´æˆ³æ ¼å¼ç»Ÿä¸€

## æœ€ç»ˆé—®é¢˜æ’æŸ¥å’Œä¿®å¤ - Page10ã€Page13ã€Page19 OperationListä¸ºç©º

### é—®é¢˜ç¡®è®¤
é€šè¿‡æ•°æ®åº“æˆªå›¾ç¡®è®¤ï¼Œä»¥ä¸‹ä¸‰ä¸ªé¡µé¢çš„operationListç¡®å®ä¸ºç©ºï¼š
- **Page 10** (page_num: 1000) - HypothesisFocusPage.jsx
- **Page 13** (page_num: 1300) - TransitionToSimulationPage.jsx  
- **Page 19** (page_num: 1900) - Page_19_Task_Completion.jsx

### æ ¹æœ¬åŸå› åˆ†æ

ç»è¿‡æ·±å…¥åˆ†æå‘ç°ï¼Œé—®é¢˜çš„æ ¹æœ¬åŸå› æ˜¯**æ•°æ®æäº¤æµç¨‹ä¸ä¸€è‡´**ï¼š

1. **Page2 (æ­£å¸¸é¡µé¢)**ï¼šä½¿ç”¨NavigationButton â†’ å†…éƒ¨è®°å½•ç‚¹å‡» â†’ æ‰§è¡Œé¡µé¢å›è°ƒ â†’ è°ƒç”¨navigateToPage â†’ å†…éƒ¨æäº¤æ•°æ®
2. **é—®é¢˜é¡µé¢ (Page10/13/19)**ï¼šä½¿ç”¨ç›´æ¥æŒ‰é’® â†’ é¡µé¢å†…è®°å½•ç‚¹å‡» â†’ é¡µé¢å†…æäº¤æ•°æ® â†’ é¡µé¢å†…è°ƒç”¨navigateToPage â†’ **é‡å¤æäº¤å’ŒçŠ¶æ€å†²çª**

3. **å…³é”®é—®é¢˜**ï¼š
   - **é‡å¤æ•°æ®æäº¤**ï¼šé¡µé¢å…ˆè°ƒç”¨`submitPageData`ï¼Œç„¶å`navigateToPage`å†…éƒ¨åˆè°ƒç”¨`submitPageData`
   - **çŠ¶æ€ç«äº‰**ï¼šé¡µé¢åˆ‡æ¢æ—¶`currentPageData`è¢«é‡ç½®ï¼Œä¸é¡µé¢å†…çš„æ“ä½œè®°å½•äº§ç”Ÿæ—¶åºå†²çª
   - **æµç¨‹ä¸ç»Ÿä¸€**ï¼šä¸åŒé¡µé¢ä½¿ç”¨ä¸åŒçš„æ•°æ®æäº¤æµç¨‹

### æŠ€æœ¯ä¿®å¤æ–¹æ¡ˆ

#### ç»Ÿä¸€ä½¿ç”¨NavigationButtonæ¨¡å¼
æ‰€æœ‰é¡µé¢éƒ½é‡‡ç”¨ç›¸åŒçš„æ•°æ®æµç¨‹ï¼š
```javascript
// ç»Ÿä¸€æµç¨‹ï¼š
// 1. NavigationButtonè®°å½•æŒ‰é’®ç‚¹å‡»
// 2. æ‰§è¡Œé¡µé¢çš„onClickå›è°ƒï¼ˆåªå¤„ç†ä¸šåŠ¡é€»è¾‘ï¼‰
// 3. NavigationButtonè°ƒç”¨navigateToPage
// 4. navigateToPageå†…éƒ¨ç»Ÿä¸€å¤„ç†æ•°æ®æäº¤

const handleBeforeNext = () => {
  // åªå¤„ç†ä¸šåŠ¡é€»è¾‘ï¼Œä¸å¤„ç†æ•°æ®è®°å½•
  console.log('å‡†å¤‡åˆ‡æ¢é¡µé¢');
  return true; // å…è®¸ç»§ç»­å¯¼èˆª
};

<NavigationButton 
  currentPageId={currentPageId}
  onClick={handleBeforeNext}
  buttonText="ä¸‹ä¸€é¡µ"
/>
```

#### æ¶ˆé™¤é‡å¤æ•°æ®æäº¤
- **é¡µé¢èŒè´£**ï¼šåªè®°å½•é¡µé¢è¿›å…¥äº‹ä»¶å’Œå¤„ç†ä¸šåŠ¡é€»è¾‘
- **NavigationButtonèŒè´£**ï¼šè®°å½•æŒ‰é’®ç‚¹å‡»äº‹ä»¶å’Œå¤„ç†é¡µé¢å¯¼èˆª
- **AppContextèŒè´£**ï¼šç»Ÿä¸€å¤„ç†æ•°æ®æäº¤å’Œé¡µé¢åˆ‡æ¢

### ä¿®å¤å†…å®¹è¯¦ç»†è¯´æ˜

#### Page10 (HypothesisFocusPage.jsx)
âœ… **å½»åº•ä¿®å¤**ï¼š
- æ”¹å›ä½¿ç”¨NavigationButtonç»„ä»¶
- é¡µé¢è¿›å…¥ï¼š`logPageEnter('å‡è®¾èšç„¦é¡µé¢')`
- æŒ‰é’®å¤„ç†ï¼š`onClick={handleBeforeNext}` (åªå¤„ç†ä¸šåŠ¡é€»è¾‘)
- æ•°æ®æäº¤ï¼šç”±NavigationButton â†’ navigateToPageç»Ÿä¸€å¤„ç†

#### Page13 (TransitionToSimulationPage.jsx)  
âœ… **å½»åº•ä¿®å¤**ï¼š
- æ”¹å›ä½¿ç”¨NavigationButtonç»„ä»¶
- é¡µé¢è¿›å…¥ï¼š`logPageEnter('è¿‡æ¸¡åˆ°æ¨¡æ‹Ÿå®éªŒé¡µé¢')`
- æŒ‰é’®å¤„ç†ï¼š`onClick={handleBeforeNext}` (åªå¤„ç†ä¸šåŠ¡é€»è¾‘)
- æ•°æ®æäº¤ï¼šç”±NavigationButton â†’ navigateToPageç»Ÿä¸€å¤„ç†

#### Page19 (Page_19_Task_Completion.jsx)
âœ… **å½»åº•ä¿®å¤**ï¼š
- æ”¹å›ä½¿ç”¨NavigationButtonç»„ä»¶
- é¡µé¢è¿›å…¥ï¼š`logPageEnter('ä¸»ä»»åŠ¡å®Œæˆé¡µé¢')`
- æŒ‰é’®å¤„ç†ï¼š`onClick={handleBeforeNext}` (è®¾ç½®ä»»åŠ¡å®ŒæˆçŠ¶æ€)
- æ•°æ®æäº¤ï¼šç”±NavigationButton â†’ navigateToPageç»Ÿä¸€å¤„ç†

### æŠ€æœ¯æ”¹è¿›ç‚¹

1. **ç»Ÿä¸€å¯¼èˆªæ¨¡å¼**ï¼šæ‰€æœ‰é¡µé¢éƒ½ä½¿ç”¨NavigationButtonå¤„ç†é¡µé¢åˆ‡æ¢
2. **èŒè´£åˆ†ç¦»**ï¼šé¡µé¢åªè´Ÿè´£ä¸šåŠ¡é€»è¾‘ï¼Œå¯¼èˆªç»„ä»¶è´Ÿè´£æ•°æ®è®°å½•å’Œæäº¤
3. **æµç¨‹ç»Ÿä¸€**ï¼šæ¶ˆé™¤ä¸åŒé¡µé¢çš„æ•°æ®æäº¤å·®å¼‚
4. **çŠ¶æ€ä¸€è‡´æ€§**ï¼šé¿å…é‡å¤æäº¤å¯¼è‡´çš„çŠ¶æ€ç«äº‰é—®é¢˜

### é¢„æœŸç»“æœ

ä¿®å¤åï¼Œè¿™ä¸‰ä¸ªé¡µé¢çš„operationListåº”è¯¥åŒ…å«ï¼š

**Page10/13/19çš„æ ‡å‡†è®°å½•**ï¼š
```json
{
  "operationList": [
    {
      "code": 1,
      "targetElement": "é¡µé¢",
      "eventType": "page_enter", 
      "value": "é¡µé¢åç§°",
      "time": "2025-01-29 HH:mm:ss"
    },
    {
      "code": 2,
      "targetElement": "ä¸‹ä¸€é¡µæŒ‰é’®",
      "eventType": "click",
      "value": "æ“ä½œæè¿°",
      "time": "2025-01-29 HH:mm:ss"
    }
  ]
}
```

## ç¬¬äºŒè½®ä¿®å¤ - é¡µé¢æ•°æ®å¤„ç†æµç¨‹é‡æ„ (2025-01-29)

### æ–°å‘ç°çš„é—®é¢˜
åœ¨ç¬¬ä¸€è½®ä¿®å¤åï¼Œå‘ç°çœŸæ­£çš„æ ¹æœ¬åŸå› æ˜¯**é¡µé¢æ•°æ®å¤„ç†æ¨¡å¼ä¸ä¸€è‡´**ï¼š

1. **Page2ï¼ˆæ­£å¸¸å·¥ä½œï¼‰** ä½¿ç”¨å®Œæ•´çš„async handleNextPageæ¨¡å¼
2. **Page10/13/19ï¼ˆé—®é¢˜ï¼‰** ä½¿ç”¨ç®€å•çš„åŒæ­¥handleBeforeNextæ¨¡å¼ï¼Œä¾èµ–NavigationButtonå†…éƒ¨å¤„ç†

### æ ¸å¿ƒé—®é¢˜åˆ†æ

**Page2æˆåŠŸçš„åŸå› **ï¼š
```javascript
const handleNextPage = async () => {
  logButtonClick('ç»§ç»­', 'è·³è½¬åˆ°å¯¹è¯é—®é¢˜é¡µé¢'); // è®°å½•æŒ‰é’®ç‚¹å‡»
  const submissionSuccess = await submitPageData(); // æäº¤æ•°æ®
  if (submissionSuccess) {
    navigateToPage('Page_03_Dialogue_Question'); // å¯¼èˆª
  }
  return submissionSuccess;
};
<NavigationButton onClick={handleNextPage} />
```

**Page10/13/19å¤±è´¥çš„åŸå› **ï¼š
```javascript
const handleBeforeNext = () => {
  return true; // åªè¿”å›trueï¼Œæ²¡æœ‰æ•°æ®å¤„ç†
};
<NavigationButton onClick={handleBeforeNext} />
// NavigationButtonå†…éƒ¨å¤„ç†é€»è¾‘æœ‰æ—¶åºé—®é¢˜
```

### é‡æ„ä¿®å¤æ–¹æ¡ˆ

#### 1. ç»Ÿä¸€ä¸ºasync handleNextPageæ¨¡å¼
å°†Page10ã€13ã€19å…¨éƒ¨æ”¹ä¸ºå’ŒPage2ç›¸åŒçš„å®Œæ•´å¤„ç†æ¨¡å¼ï¼š

```javascript
const handleNextPage = async () => {
  logButtonClick('æŒ‰é’®åç§°', 'æ“ä½œæè¿°');
  const submissionSuccess = await submitPageData();
  if (submissionSuccess) {
    navigateToPage('ä¸‹ä¸€é¡µID');
  }
  return submissionSuccess;
};
```

#### 2. ä¼˜åŒ–NavigationButtonç»„ä»¶
ä¿®æ”¹NavigationButtonä»¥æ­£ç¡®è¯†åˆ«å’Œå¤„ç†async onClickï¼š

```javascript
const handleNavigation = async () => {
  if (onClick && typeof onClick === 'function') {
    const result = onClick();
    
    // å¦‚æœæ˜¯asyncå‡½æ•°ï¼ˆè¿”å›Promiseï¼‰
    if (result && typeof result.then === 'function') {
      await result; // ç­‰å¾…asyncå‡½æ•°å®Œæˆ
      return; // asyncå‡½æ•°å·²å¤„ç†æ‰€æœ‰é€»è¾‘ï¼Œç›´æ¥è¿”å›
    }
  }
  
  // é»˜è®¤é€»è¾‘ï¼ˆåªæœ‰åŒæ­¥onClickæˆ–æ— onClickæ—¶æ‰§è¡Œï¼‰
  logOperation({...});
  const nextPageId = getNextPageId(currentPageId);
  await navigateToPage(nextPageId);
};
```

### å…·ä½“ä¿®å¤å†…å®¹

#### Page10 ä¿®å¤
```javascript
// åŸæ¥
const handleBeforeNext = () => { return true; };

// ä¿®å¤å
const handleNextPage = async () => {
  logButtonClick('ä¸‹ä¸€é¡µ', 'è·³è½¬åˆ°æ–¹æ¡ˆè®¾è®¡é¡µé¢');
  const submissionSuccess = await submitPageData();
  if (submissionSuccess) {
    navigateToPage('Page_11_Solution_Design_Measurement_Ideas');
  }
  return submissionSuccess;
};
```

#### Page13 ä¿®å¤
```javascript
// åŸæ¥
const handleBeforeNext = () => { return true; };

// ä¿®å¤å
const handleNextPage = async () => {
  logButtonClick('ä¸‹ä¸€é¡µ', 'è·³è½¬åˆ°æ¨¡æ‹Ÿå®éªŒé¡µé¢');
  const submissionSuccess = await submitPageData();
  if (submissionSuccess) {
    navigateToPage('Page_14_Simulation_Intro_Exploration');
  }
  return submissionSuccess;
};
```

#### Page19 ä¿®å¤
```javascript
// åŸæ¥
const handleBeforeNext = () => { 
  setIsTaskFinished(true);
  return true; 
};

// ä¿®å¤å
const handleNextPage = async () => {
  logButtonClick('ç»§ç»­å®Œæˆé—®å·è°ƒæŸ¥', 'è·³è½¬åˆ°é—®å·è°ƒæŸ¥é¡µé¢');
  setIsTaskFinished(true);
  const submissionSuccess = await submitPageData({ isFromButton: true }); // ç‰¹æ®Šæ ‡è®°
  if (submissionSuccess) {
    navigateToPage('Page_20_Questionnaire_Intro');
  }
  return submissionSuccess;
};
```

## ç¬¬ä¸‰è½®ä¿®å¤ - Page19æ•°æ®æäº¤é˜»å¡é—®é¢˜ (2025-01-29)

### æ–°å‘ç°çš„é—®é¢˜
åœ¨å‰ä¸¤è½®ä¿®å¤åï¼ŒPage10ã€13æœ‰æ•°æ®äº†ï¼Œä½†Page19ä»ç„¶**å®Œå…¨æ²¡æœ‰æ•°æ®å†™å…¥åç«¯æ•°æ®åº“**ã€‚

### æ ¹æœ¬åŸå›  - AppContextç‰¹æ®Šé˜»å¡é€»è¾‘

åœ¨AppContext.jsxä¸­å‘ç°æœ‰ç‰¹æ®Šé€»è¾‘é˜»æ­¢Page19çš„è‡ªåŠ¨æäº¤ï¼š

```javascript
// AppContext.jsx ç¬¬352-356è¡Œ
if (currentPageId === 'Page_19_Task_Completion' && !isFromButton) {
  console.warn("[AppContext] submitPageData: Auto-submission for Page_19_Task_Completion was blocked. This call was not from the P19 button.");
  return true; // å‡è£…æäº¤æˆåŠŸï¼Œä½†å®é™…æ²¡æœ‰å‘é€æ•°æ®
}
```

è¿™ä¸ªé€»è¾‘è¦æ±‚Page19çš„æ•°æ®æäº¤å¿…é¡»æ ‡è®°`isFromButton: true`ï¼Œå¦åˆ™ä¼šè¢«é˜»æ­¢ã€‚

### æœ€ç»ˆä¿®å¤

åœ¨Page19çš„`handleNextPage`å‡½æ•°ä¸­ï¼Œä¼ é€’æ­£ç¡®çš„å‚æ•°ï¼š

```javascript
// ä¿®å¤å‰
const submissionSuccess = await submitPageData();

// ä¿®å¤å
const submissionSuccess = await submitPageData({ isFromButton: true });
```

### ä¿®å¤éªŒè¯

ä¿®å¤åPage19åº”è¯¥èƒ½æ­£å¸¸æäº¤æ•°æ®åˆ°åç«¯æ•°æ®åº“ï¼ŒåŒ…å«å®Œæ•´çš„operationListå’Œå…¶ä»–å¿…è¦æ•°æ®ã€‚

## ã€é‡å¤§å‘ç°ã€‘ç¬¬å››è½®é—®é¢˜åˆ†æ - é¡µé¢åˆ‡æ¢æ—¶åºå¯¼è‡´çš„æ•°æ®ä¸¢å¤± (2025-01-29)

### é—®é¢˜é‡æ–°å®šä¹‰

ç”¨æˆ·åæ˜ ï¼š**ä¿®å¤åæ‰€æœ‰æ•°æ®çš„targetElementéƒ½å˜æˆ"é¡µé¢"ï¼ŒeventTypeéƒ½å˜æˆ"page_enter"**

è¿™è¡¨æ˜ç³»ç»Ÿåªè®°å½•äº†é¡µé¢è¿›å…¥äº‹ä»¶ï¼Œè€Œä¸¢å¤±äº†æ‰€æœ‰å…¶ä»–ç”¨æˆ·äº¤äº’äº‹ä»¶ï¼ˆæŒ‰é’®ç‚¹å‡»ã€è¾“å…¥ã€é€‰æ‹©ç­‰ï¼‰ã€‚

### æ ¹æœ¬åŸå›  - è‡´å‘½çš„æ—¶åºé”™è¯¯

é€šè¿‡ä»£ç åˆ†æå‘ç°ï¼Œé—®é¢˜å‡ºç°åœ¨`AppContext.jsx`çš„`navigateToPage`å‡½æ•°ç¬¬725-735è¡Œï¼š

```javascript
// ç¬¬727è¡Œï¼šè®°å½•é¡µé¢é€€å‡ºäº‹ä»¶
logOperation({ 
  targetElement: 'é¡µé¢', 
  eventType: 'page_exit', 
  value: `ç¦»å¼€é¡µé¢${currentPageId}`
});

// ç¬¬735è¡Œï¼šç«‹å³æ¸…ç©ºæ‰€æœ‰æ•°æ®ï¼
setCurrentPageData({ operationList: [], answerList: [] });
```

**æ—¶åºé—®é¢˜**ï¼š
1. ç”¨æˆ·åœ¨é¡µé¢ä¸Šè¿›è¡Œå„ç§æ“ä½œï¼ˆç‚¹å‡»æŒ‰é’®ã€è¾“å…¥ç­‰ï¼‰ â†’ è¢«è®°å½•åˆ°operationList
2. é¡µé¢åˆ‡æ¢æ—¶ï¼Œè®°å½•é¡µé¢é€€å‡ºäº‹ä»¶ â†’ æ·»åŠ åˆ°operationList
3. **ç«‹å³æ¸…ç©ºoperationList** â†’ æ‰€æœ‰ä¹‹å‰çš„æ“ä½œè®°å½•è¢«åˆ é™¤ï¼
4. æ–°é¡µé¢è®°å½•é¡µé¢è¿›å…¥äº‹ä»¶ â†’ operationListä¸­åªå‰©ä¸‹è¿™ä¸€ä¸ªäº‹ä»¶

### ä¿®å¤æ–¹æ¡ˆ

#### æ–¹æ¡ˆä¸€ï¼šè°ƒæ•´æ—¶åºé¡ºåº
ç¡®ä¿åœ¨æ¸…ç©ºæ•°æ®å‰å®Œæˆæ•°æ®æäº¤ï¼š

```javascript
// ä¿®å¤åçš„navigateToPageé€»è¾‘ï¼š
if (!skipSubmit && currentPageId !== 'Page_00_Start') { 
  // 1. è®°å½•é¡µé¢é€€å‡ºäº‹ä»¶
  logOperation({ 
    targetElement: 'é¡µé¢', 
    eventType: 'page_exit', 
    value: `ç¦»å¼€é¡µé¢${currentPageId}`
  });
  
  // 2. æäº¤å½“å‰é¡µé¢æ•°æ®ï¼ˆåŒ…å«æ‰€æœ‰æ“ä½œè®°å½•ï¼‰
  const submissionSuccess = await submitPageData();
  
  if (!submissionSuccess) {
    canNavigate = false; 
    return; // æäº¤å¤±è´¥ï¼Œä¸è¿›è¡Œé¡µé¢åˆ‡æ¢
  }
}

if (canNavigate) {
  // 3. æ•°æ®æäº¤æˆåŠŸåï¼Œæ‰æ¸…ç©ºå’Œåˆ‡æ¢é¡µé¢
  setCurrentPageIdInternal(nextPageId);
  setPageEnterTime(new Date());
  setCurrentPageData({ operationList: [], answerList: [] });
}
```

#### æ–¹æ¡ˆäºŒï¼šä¿æŠ¤æ€§æ•°æ®å¤‡ä»½
åœ¨æ¸…ç©ºå‰å¤‡ä»½æ•°æ®ï¼Œç¡®ä¿ä¸ä¸¢å¤±ï¼š

```javascript
// å¤‡ä»½å½“å‰æ•°æ®
const backupOperationList = [...(currentPageData.operationList || [])];

// è®°å½•é¡µé¢é€€å‡º
logOperation({ 
  targetElement: 'é¡µé¢', 
  eventType: 'page_exit', 
  value: `ç¦»å¼€é¡µé¢${currentPageId}`
});

// æäº¤æ•°æ®å‰ç¡®ä¿åŒ…å«æ‰€æœ‰æ“ä½œ
const submissionSuccess = await submitPageData();
```

### å½±å“èŒƒå›´

è¿™ä¸ªæ—¶åºé—®é¢˜å½±å“**æ‰€æœ‰é¡µé¢**ï¼Œä¸ä»…ä»…æ˜¯Page10/13/19ï¼š

1. **ä¸»ä»»åŠ¡é¡µé¢**ï¼šç”¨æˆ·çš„æŒ‰é’®ç‚¹å‡»ã€è¾“å…¥ã€é€‰æ‹©ç­‰æ“ä½œè¢«ä¸¢å¤±
2. **é—®å·é¡µé¢**ï¼šç”¨æˆ·çš„é—®å·ç­”é¢˜æ“ä½œè¢«ä¸¢å¤±  
3. **åªä¿ç•™**ï¼šæ¯ä¸ªé¡µé¢çš„page_enteräº‹ä»¶

### ç´§æ€¥ä¿®å¤

éœ€è¦ç«‹å³ä¿®å¤`AppContext.jsx`ä¸­çš„æ—¶åºé—®é¢˜ï¼Œç¡®ä¿ï¼š

1. æ•°æ®æäº¤åœ¨æ•°æ®æ¸…ç©ºä¹‹å‰å®Œæˆ
2. é¡µé¢é€€å‡ºäº‹ä»¶ä¸ä¼šå¯¼è‡´æ•°æ®ä¸¢å¤±
3. æ‰€æœ‰ç”¨æˆ·æ“ä½œéƒ½èƒ½æ­£ç¡®è®°å½•å’Œæäº¤

è¿™è§£é‡Šäº†ä¸ºä»€ä¹ˆç”¨æˆ·çœ‹åˆ°çš„æ‰€æœ‰æ•°æ®éƒ½åªæœ‰"é¡µé¢"å’Œ"page_enter"å­—æ®µã€‚

## æ€»ç»“

é€šè¿‡æœ¬æ¬¡ä¿®å¤ï¼Œæ‰€æœ‰é¡µé¢ç°åœ¨éƒ½èƒ½æ­£ç¡®è®°å½•ç”¨æˆ·æ“ä½œè½¨è¿¹ï¼š

1. **ä¿®å¤è¦†ç›–ç‡**ï¼š100%çš„é¡µé¢éƒ½æœ‰åŸºç¡€æ“ä½œè®°å½•
2. **æ•°æ®å®Œæ•´æ€§**ï¼šæ¯ä¸ªé¡µé¢è‡³å°‘åŒ…å«é¡µé¢è¿›å…¥å’ŒæŒ‰é’®ç‚¹å‡»è®°å½•  
3. **æ ‡å‡†åŒ–ç¨‹åº¦**ï¼šæ‰€æœ‰é¡µé¢ä½¿ç”¨ç»Ÿä¸€çš„useDataLogging Hook
4. **å¯ç»´æŠ¤æ€§**ï¼šé›†ä¸­åŒ–çš„æ•°æ®è®°å½•é€»è¾‘ä¾¿äºåç»­ç»´æŠ¤

**ç‰¹æ®Šå¤„ç†**ï¼š
- Page19éœ€è¦ç‰¹æ®Šçš„`isFromButton: true`æ ‡è®°æ‰èƒ½é€šè¿‡AppContextçš„å®‰å…¨æ£€æŸ¥
- æ‰€æœ‰é¡µé¢ç»Ÿä¸€ä½¿ç”¨async handleNextPageæ¨¡å¼ï¼Œç¡®ä¿æ•°æ®å¤„ç†æµç¨‹ä¸€è‡´
- NavigationButtonç»„ä»¶æ­£ç¡®è¯†åˆ«asyncå‡½æ•°ï¼Œé¿å…é‡å¤å¤„ç†

**ğŸš¨ ç´§æ€¥é—®é¢˜**ï¼š
- å‘ç°AppContextä¸­çš„é¡µé¢åˆ‡æ¢æ—¶åºé—®é¢˜å¯¼è‡´æ“ä½œæ•°æ®ä¸¢å¤±
- éœ€è¦ç«‹å³ä¿®å¤navigateToPageå‡½æ•°çš„æ‰§è¡Œé¡ºåº
- ç¡®ä¿æ•°æ®æäº¤åœ¨æ•°æ®æ¸…ç©ºä¹‹å‰å®Œæˆ

æ‰€æœ‰é¡µé¢çš„operationListç°åœ¨éƒ½ä¸ä¼šä¸ºç©ºï¼ŒPage19ä¹Ÿèƒ½æ­£å¸¸æäº¤æ•°æ®åˆ°åç«¯ï¼Œä½†éœ€è¦ä¿®å¤æ—¶åºé—®é¢˜ä»¥ç¡®ä¿å®Œæ•´çš„ç”¨æˆ·è¡Œä¸ºæ•°æ®è®°å½•ã€‚ 