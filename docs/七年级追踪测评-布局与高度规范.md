# 七年级追踪测评：页面高度与布局统一规范

版本：1.0  
适用范围：`src/modules/grade-7-tracking`（七年级追踪测评模块）及后续新增的同类模块

## 背景与问题

- 现状：追踪测评分支采用“容器随视口高度填满 + 子元素大量 `height: 100%/100vh`”的组合，导致在大屏幕（高分辨率显示器）下，内容区被拉伸变形，影响美观与信息密度的稳定性。
- 典型触发点：
  - `src/modules/grade-7-tracking/styles/PageLayout.module.css:13` 使用 `height: 100vh`；
  - 多个页面/组件样式存在 `height: 100%`、`min-height: calc(100vh - ...)` 等链式放大（例如 `ExplorationPages.module.css`、`Page0x_*.module.css` 等）。
- 传统“蒸馒头（非追踪）”页面更接近“受控内容区 + 居中 + 溢出滚动”的模式，视觉更稳定。本规范将追踪测评分支对齐到“固定内容画布”的统一策略。

## 目标

- 始终在一个固定的“内容画布”内呈现页面，屏幕增高时整体居中显示，避免内部组件被拉伸。  
- 小屏幕时允许内容区内部滚动，不对组件进行非等比缩放，保持字号、间距与组件比例的一致性。

## 统一规范（硬性要求）

- 固定内容高度：`800px`（标准值）。
- 固定内容最大宽度：`1200px`；小屏时横向 `max-width: 100%`。
- 居中显示：当视口高度大于内容高度时，内容需垂直+水平居中显示。
- 根布局高度：使用 `min-height: 100vh`，禁止在根容器使用强制 `height: 100vh`。
- 视口耦合：禁止在页面根节点或主要容器上使用 `height: 100%/100vh` 形成高度链式放大；允许在“内容外框”的内部局部区域使用固定像素高度或可滚区域。
- 计时器（Timer）压缩规则（小屏）：
  - 不允许换行（single-line）。
  - 不允许缩小内边距（保持统一的内边距视觉节奏）。
  - 允许轻微缩小字体以维持单行（如从 18px 降到 16px）；极小屏宽（≤360px）时优先通过缩小字体保持单行与内边距，避免挤压。

## 推荐样式（可直接落地）

以下为在追踪模块 PageLayout 层的基础样式片段，建议合并到 `src/modules/grade-7-tracking/styles/PageLayout.module.css`：

```css
/* 根布局：避免强制 100vh，使用 min-height 提供上限 */
.pageLayout {
  display: flex;
  width: 100%;
  min-height: 100vh; /* 替换 height: 100vh */
  background-color: #f9f9f9;
  overflow: hidden;
}

/* 主内容区：在高度大于内容时，将内容垂直 + 水平居中 */
.mainContent {
  flex: 1;
  display: flex;
  align-items: center;     /* 垂直居中 */
  justify-content: center; /* 水平居中 */
  position: relative;
  overflow: hidden;
}

/* 内容包装：保留滚动能力，但不再承担“拉伸”职责 */
.contentWrapper {
  flex: 1;
  padding: 80px 40px 40px 40px; /* 与计时器避让一致 */
  overflow: auto; /* 当屏幕较小，允许内容内部滚动 */
  box-sizing: border-box;
  display: flex;
  align-items: center;
  justify-content: center;
}

/* 统一内容外框（白底 + 圆角 + 阴影）：固定宽高 + 居中 */
.contentFrame {
  width: 1200px;
  max-width: 100%;
  height: 800px;                            /* 固定内容高度标准值 */
  max-height: calc(100vh - 160px);          /* 极小屏时的兜底上限 */
  background: #fff;                          /* 白底 */
  border-radius: 12px;                       /* 圆角 */
  box-shadow: 0 8px 24px rgba(0, 0, 0, 0.08);/* 阴影 */
  overflow: auto;                            /* 内容滚动 */
  box-sizing: border-box;
  padding: 24px 28px;                        /* 统一内边距 */
}

/* 计时器：单行 + 固定内边距，不换行 */
.timerContainer {
  position: fixed;
  top: 55px;
  right: 20px;
  display: inline-flex;
  align-items: center;
  gap: 8px;
  background-color: var(--cartoon-secondary);
  color: var(--text-color);
  padding: 12px 20px;        /* 固定内边距：不随屏幕缩小而减少 */
  border-radius: 30px;
  box-shadow: 0 4px 10px var(--cartoon-shadow);
  z-index: 999;
  font-size: 18px;           /* 默认字体大小 */
  font-weight: bold;
  border: 2px solid #ffb347;
  white-space: nowrap;        /* 禁止换行 */
}

/* 超小屏（≤360px）时：保持单行与内边距，允许轻微减小字号 */
@media (max-width: 360px) {
  .timerContainer {
    font-size: 16px; /* 仅减小字体，内边距与单行不变 */
  }
}
```

使用方式（PageLayout 侧包裹 children）：

```jsx
// src/modules/grade-7-tracking/components/layout/PageLayout.jsx
// 仅示意：在 contentWrapper 内包一层 contentFrame
<div className={`${styles.contentWrapper} ${!showTimer ? styles.noTimer : ''}`}>
  <div className={styles.contentFrame}>{children}</div>
  {/* 如需：也可在具体页面文件中自行包裹 contentFrame */}
  {/* 但全局统一由 PageLayout 统一包裹，落地成本更低且一致性更高 */}
  {/* 注意：不要在 contentFrame 外层/同层再次设置 100%/100vh 高度 */}
  {/*       局部需要固定高度的组件，应在 contentFrame 内使用固定 px 高度容器 */}
</div>
```

## 组件与页面布局约束

- 图表/可视化（Chart.js、Recharts 等）：
  - 容器高度使用固定像素（如 300–360px），避免 `height: 100%` 与视口高度链式耦合；
  - Chart.js 设置 `maintainAspectRatio: true`；`<ResponsiveContainer height={300}>`（Recharts）。
- 图片/插画：
  - 使用 `max-width: 100%` + `height: auto`；必要时用 `aspect-ratio` 保持比例；严禁因父容器高度被拉伸导致变形。
- 左侧导航（`leftNavWrapper` 与 `leftNavigation`）：
  - 宽度保持 `100px`，在低高度屏幕下通过减少 `navConnector` 高度/间距与列表区域滚动来压缩，不降低点击触达面积；
  - 不与视口高度绑定进行非等比拉伸。

## 禁止模式（Anti-pattern）

- 在页面根或主要容器上使用：
  - `height: 100vh`（应改为 `min-height: 100vh`）。
  - `height: 100%` 与外层 100%/100vh 连锁导致整体拉伸。
- 计时器容器：
  - 换行（wrap）或减少内边距来“挤压”内容；本规范要求固定内边距与单行，通过缩小字体来兜底。

## 落地步骤（建议）

1) PageLayout 骨架对齐：
   - `src/modules/grade-7-tracking/styles/PageLayout.module.css:13`：`height: 100vh` → `min-height: 100vh`；
   - `.mainContent` 启用 `align-items: center; justify-content: center;`；
   - 在 `.contentWrapper` 内统一包裹 `.contentFrame`（如上）。

2) 页级样式去除高度链：
   - `ExplorationPages.module.css`、`Page0x_*.module.css` 里将 `height: 100%` / `min-height: calc(100vh - ...)` 改为：
     - 在 `.contentFrame` 内对需要滚动的分区设置固定 px 高度 + `overflow: auto`；
     - 其余块不指定高度，随内容自适应。

3) 组件容器改造：
   - 图表、表格、可滚面板等，采用固定像素高度容器；避免使用百分比高度绑定视口。

4) 计时器与左侧导航对齐：
   - 计时器不换行、固定内边距，在 ≤360px 时仅减小字体；
   - 左侧导航通过减少连接线间距与开启滚动压缩，不缩放组件导致变形。

## 验收标准

- 1920×1080、2560×1440：内容始终在 1200×800 画布内，整体居中，组件比例稳定；
- 1366×768 及以下：内容框维持固定高度，内部出现滚动条而非拉伸/变形；
- 计时器在各分辨率下均保持单行与固定内边距；
- 左侧导航在矮屏下通过滚动与间距调整保持可用性，不发生拉伸变形。

## 变更影响面（文件参考）

- 布局与基础样式：
  - `src/modules/grade-7-tracking/styles/PageLayout.module.css`
  - `src/modules/grade-7-tracking/components/layout/PageLayout.jsx`
- 页级样式（示例）：
  - `src/modules/grade-7-tracking/styles/ExplorationPages.module.css`
  - `src/modules/grade-7-tracking/styles/Page0x_*.module.css`
- 可视化/容器：
  - `src/modules/grade-7-tracking/components/visualizations/*`
  - `src/modules/grade-7-tracking/components/experiment/*`

---

注：若需我直接在上述文件中落地 `.contentFrame` 与相关改造（保持最小侵入），可基于本规范提交一个演示性变更以便团队对齐与评审。

